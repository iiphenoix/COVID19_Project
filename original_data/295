b'<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n    \n    <head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\n        <!-- AppResources meta begin -->\n        <script type="text/javascript">var ncbi_startTime = new Date();</script>\n        <!-- AppResources meta end -->\n        \n        <!-- TemplateResources meta begin -->\n        <meta name="paf_template" content="" />\n\n        <!-- TemplateResources meta end -->\n        \n        <!-- Logger begin -->\n        <meta name="ncbi_db" content="pmc" /><meta name="ncbi_pdid" content="article" /><meta name="ncbi_acc" content="" /><meta name="ncbi_domain" content="phenaturepg" /><meta name="ncbi_report" content="record" /><meta name="ncbi_type" content="fulltext" /><meta name="ncbi_objectid" content="" /><meta name="ncbi_pcid" content="/articles/PMC1853084/" /><meta name="ncbi_app" content="pmc" />\n        <!-- Logger end -->\n        \n        <title>Incorporating indel information into phylogeny estimation for rapidly emerging pathogens</title>\n        \n        <!-- AppResources external_resources begin -->\n        <link rel="stylesheet" href="/core/jig/1.14.8/css/jig.min.css" /><script type="text/javascript" src="/core/jig/1.14.8/js/jig.min.js"></script>\n\n        <!-- AppResources external_resources end -->\n        \n        <!-- Page meta begin -->\n        <meta name="robots" content="INDEX,NOFOLLOW,NOARCHIVE" /><link rel="canonical" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1853084/" /><link rel="schema.DC" href="http://purl.org/DC/elements/1.0/" /><meta name="citation_journal_title" content="BMC Evolutionary Biology" /><meta name="citation_title" content="Incorporating indel information into phylogeny estimation for rapidly emerging pathogens" /><meta name="citation_authors" content="Benjamin D Redelings, Marc A Suchard" /><meta name="citation_date" content="2007" /><meta name="citation_volume" content="7" /><meta name="citation_doi" content="10.1186/1471-2148-7-40" /><meta name="citation_abstract_html_url" content="/pmc/articles/PMC1853084/?report=abstract" /><meta name="citation_pmid" content="17359539" /><meta name="DC.Title" content="Incorporating indel information into phylogeny estimation for rapidly emerging pathogens" /><meta name="DC.Type" content="Text" /><meta name="DC.Publisher" content="Nature Publishing Group" /><meta name="DC.Contributor" content="Benjamin D Redelings" /><meta name="DC.Contributor" content="Marc A Suchard" /><meta name="DC.Date" content="2007" /><meta name="DC.Identifier" content="10.1186/1471-2148-7-40" /><meta name="DC.Language" content="en" /><meta property="og:title" content="Incorporating indel information into phylogeny estimation for rapidly emerging pathogens" /><meta property="og:type" content="article" /><meta property="og:description" content="Phylogenies of rapidly evolving pathogens can be difficult to resolve because of the small number of substitutions that accumulate in the short times since divergence. To improve resolution of such phylogenies we propose using insertion and deletion (indel) ..." /><meta property="og:url" content="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1853084/" /><meta property="og:site_name" content="PubMed Central (PMC)" /><meta property="og:image" content="https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-logo-share.png" /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@ncbi" /><link rel="stylesheet" href="/corehtml/pmc/css/3.14.1/pmc.min.css" type="text/css" /><link rel="stylesheet" href="/corehtml/pmc/css/3.14.1/pmc_extras_prnt.min.css" type="text/css" media="print" /><script type="text/javascript" src="/corehtml/pmc/js/common.min.js">//</script><script type="text/javascript" src="/corehtml/pmc/js/NcbiTagServer.min.js">//</script><meta name="citationexporter" content="backend:\'https://api.ncbi.nlm.nih.gov/lit/ctxp/v1/pmc/\'" /><script type="text/javascript" src="https://www.ncbi.nlm.nih.gov/corehtml/pmc/ctxp/jquery.citationexporter.min.js">//</script><link rel="stylesheet" href="https://www.ncbi.nlm.nih.gov/corehtml/pmc/ctxp/citationexporter.css" type="text/css" /><script type="text/javascript" src="/core/mathjax/2.6.1/MathJax.js?config=/corehtml/pmc/js/mathjax-config-classic.3.4.js"></script><script type="text/javascript">window.name="mainwindow";</script><style type="text/css">.pmc-wm {background:transparent repeat-y top left;background-image:url(/corehtml/pmc/pmcgifs/wm-phenaturepg.gif);background-size: auto, contain}</style><style type="text/css">.print-view{display:block}</style><style type="text/css">\n        div.pmc_para_cit li.highlight,\n        div.pmc_para_cit li.highlight .one_line_source\n        { background: #E0E0E0; }\n        a.bibr.highlight { background: #E0E0E0; } \n      </style><meta name="cited_in_systematic_reviews" content="" /><link rel="alternate" type="application/epub+zip" href="/pmc/articles/PMC1853084/epub/" /><link rel="alternate" type="application/pdf" href="/pmc/articles/PMC1853084/pdf/12862_2006_Article_334.pdf" />\n\n        <!-- Page meta end -->\n    <link rel="shortcut icon" href="//www.ncbi.nlm.nih.gov/favicon.ico" /><meta name="ncbi_phid" content="8A1A6FD0E999E28100000000093E093D.m_8" />\n<meta name=\'referrer\' content=\'origin-when-cross-origin\'/><link type="text/css" rel="stylesheet" href="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/css/3852956/3985586/3808861/4121862/3974050/3917732/251717/4048120/3846471/14534/45193/4113719/3849091/3984811/3751656/4033350/3840896/3577051/3852958/3881636/3579733/4062871/12930/3964959/3855473/4047625/3854974/3854955/4076335/4128070/9685/3549676/3609192/3609193/3609213/3395586/4143404.css" /><link type="text/css" rel="stylesheet" href="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/css/3411343/3882866/4157116.css" media="print" /></head>\n    <body class="article">\n        <div class="grid">\n            <div class="col twelve_col nomargin shadow">\n                <!-- System messages like service outage or JS required; this is handled by the TemplateResources portlet -->\n                <div class="sysmessages">\n                    <noscript>\n\t<p class="nojs">\n\t<strong>Warning:</strong>\n\tThe NCBI web site requires JavaScript to function. \n\t<a href="/guide/browsers/#enablejs" title="Learn how to enable JavaScript" target="_blank">more...</a>\n\t</p>\n\t</noscript>\n                </div>\n                <!--/.sysmessage-->\n                <div class="wrap">\n                    <div class="page">\n                        <div class="top">\n                            <div class="universal_header" id="universal_header"><ul class="inline_list jig-ncbimenu ui-ncbimenu resources_list" id="navcontent"><li class="ui-ncbimenu-item-leaf ui-ncbimenu-item-first ui-helper-reset ui-ncbimenu-item-no-hlt"><a class="ui-ncbimenu-link-first" href="/" role="banner" title="NCBI Home" id="ncbihome" accesskey="1"><span class="offscreen_noflow">NCBI</span><img src="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/img/28977" class="ncbi_logo" title="NCBI" alt="NCBI Logo" /></a></li><li class="offscreen_noflow ui-ncbimenu-item-skip access"><a href="#maincontent" title="Skip to the content" tabindex="0" accesskey="3">Skip to main\n                        content</a></li><li class="offscreen_noflow ui-ncbimenu-item-skip access"><a href="#navcontent" title="Skip to the navigation" tabindex="0" accesskey="4">Skip to\n                        navigation</a></li><li id="resource-menu" class="topmenu ui-helper-reset ui-ncbimenu-item-first ui-helper-reset"><a class="ui-ncbimenu-first-link-has-submenu ui-ncbimenu-link-first topanchor expandDown" href="/static/header_footer_ajax/submenu/#resources">Resources</a></li><li id="all-howtos-menu" class="topmenu ui-helper-reset ui-ncbimenu-item-first"><a class="ui-ncbimenu-first-link-has-submenu ui-ncbimenu-link-first topanchor expandDown" href="/static/header_footer_ajax/submenu/#howto">How To</a></li><li class="offscreen_noflow ui-ncbimenu-item-skip access"><a href="/guide/browsers/#accesskeys" title="About My NCBI Accesskeys" tabindex="0" accesskey="0">About NCBI Accesskeys</a></li></ul><div class="myncbi"><span id="myncbiusername" style="display:none"><a href="/account/settings/" id="mnu" title="Edit account settings"></a></span><a accesskey="2" href="/myncbi/" id="myncbi" style="display:none">My NCBI</a><a href="/account/" id="sign_in">Sign in to NCBI</a><a href="/account/signout/" id="sign_out" style="display:none">Sign Out</a></div></div>\n                            <div class="header">\n    <div class="res_logo">\n  <h1 class="img_logo"><a href="/pmc/" class="pmc_logo offscreen">PMC</a></h1>\n  <div class="NLMLogo">\n    <a href="https://www.nlm.nih.gov/" title="US National Library of Medicine">US National Library of Medicine</a>\n    <br />\n    <a href="https://www.nih.gov/" title="National Institutes of Health">National Institutes of Health</a>\n  </div>\n</div>\n    <div class="search"><form method="get" action="/pmc/"><div class="search_form"><label for="database" class="offscreen_noflow">Search database</label><select id="database"><optgroup label="Recent"><option value="pmc" selected="selected" class="last" data-ac_dict="pmc-search-autocomplete">PMC</option></optgroup><optgroup label="All"><option value="gquery">All Databases</option><option value="assembly">Assembly</option><option value="biocollections">Biocollections</option><option value="bioproject">BioProject</option><option value="biosample">BioSample</option><option value="biosystems">BioSystems</option><option value="books">Books</option><option value="clinvar">ClinVar</option><option value="cdd">Conserved Domains</option><option value="gap">dbGaP</option><option value="dbvar">dbVar</option><option value="gene">Gene</option><option value="genome">Genome</option><option value="gds">GEO DataSets</option><option value="geoprofiles">GEO Profiles</option><option value="gtr">GTR</option><option value="homologene">HomoloGene</option><option value="ipg">Identical Protein Groups</option><option value="medgen">MedGen</option><option value="mesh">MeSH</option><option value="ncbisearch">NCBI Web Site</option><option value="nlmcatalog">NLM Catalog</option><option value="nuccore">Nucleotide</option><option value="omim">OMIM</option><option value="pmc" data-ac_dict="pmc-search-autocomplete">PMC</option><option value="popset">PopSet</option><option value="probe">Probe</option><option value="protein">Protein</option><option value="proteinclusters">Protein Clusters</option><option value="pcassay">PubChem BioAssay</option><option value="pccompound">PubChem Compound</option><option value="pcsubstance">PubChem Substance</option><option value="pubmed">PubMed</option><option value="snp">SNP</option><option value="sparcle">Sparcle</option><option value="sra">SRA</option><option value="structure">Structure</option><option value="taxonomy">Taxonomy</option><option value="toolkit">ToolKit</option><option value="toolkitall">ToolKitAll</option><option value="toolkitbookgh">ToolKitBookgh</option></optgroup></select><div class="nowrap"><label for="term" class="offscreen_noflow" accesskey="/">Search term</label><div class="nowrap"><input type="text" name="term" id="term" title="Search PMC. Use up and down arrows to choose an item from the autocomplete." value="" class="jig-ncbiclearbutton jig-ncbiautocomplete" data-jigconfig="dictionary:\'pmc-search-autocomplete\',disableUrl:\'NcbiSearchBarAutoComplCtrl\'" autocomplete="off" data-sbconfig="ds:\'no\',pjs:\'no\',afs:\'yes\'" /></div><button id="search" type="submit" class="button_search nowrap" cmd="go">Search</button></div></div></form><ul class="searchlinks inline_list"><li>\n                        <a href="/pmc/advanced/">Advanced</a>\n                    </li><li>\n                        <a href="/pmc/journals/">Journal list</a>\n                    </li><li class="help">\n                        <a target="_blank" href="/books/NBK3825/">Help</a>\n                    </li></ul></div>\n</div>\n\n                            \n                            \n                        <!--<component id="Page" label="headcontent"/>-->\n                            \n                        </div>\n                        <div class="content">\n                            <!-- site messages -->\n                            <div class="container">\n    <div id="maincontent" class="content eight_col col">\n        <div class="navlink-box">\n            <ul class="page-breadcrumbs inline_list small"><li class="journal-list"><a href="/pmc/journals/" class="navlink">Journal List</a></li><li class="article-entrez-filter"><a href="/pmc/?term=Nature%20Public%20Health%20Emergency%20Collection[filter]" class="navlink">Nature Public Health Emergency Collection</a></li><li class="accid">PMC1853084</li></ul>\n        </div>\n\n        <!-- Journal banner -->\n        <div class="pmc-page-banner whole_rhythm"><div class="banner-generic-logo-background inline_block"><div class="banner-journal-publisher-over-image"><div class="banner-journal-name bl-jtitle-phenaturepg">BMC Evolutionary Biology</div><div class="banner-publisher-name">Nature Publishing Group</div></div></div></div>\n        \n        <!--component id=\'MainPortlet\' label=\'search-reference\'/-->\n        \n        <!-- Book content -->\n        <div class="">\n            \n        \n            \n            <div class="hide-overflow article lit-style content pmc-wm slang-all page-box"><!--main-content--><div class="jig-ncbiinpagenav" data-jigconfig="smoothScroll: false, allHeadingLevels: [\'h2\'], headingExclude: \':hidden\'"><div class="fm-sec half_rhythm no_top_margin"><div class="fm-citation half_rhythm no_top_margin clearfix"><div class="inline_block eight_col va_top"><div><div><span class="cit"><span id="pmcmata">BMC Evol Biol</span>. 2007; 7: 40. </span></div><div><span class="fm-vol-iss-date">Published online 2007 Mar 14. </span>  <span class="doi">doi:\xc2\xa0<a href="//dx.doi.org/10.1186%2F1471-2148-7-40" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CFront%20Matter&amp;TO=Content%20Provider%7CCrosslink%7CDOI">10.1186/1471-2148-7-40</a></span></div></div></div><div class="inline_block four_col va_top show-overflow align_right"><div class="fm-citation-ids"><div class="fm-citation-pmcid"><span class="fm-citation-ids-label">PMCID: </span><span>PMC1853084</span></div><div class="fm-citation-pmid">PMID: <a href="/pubmed/17359539">17359539</a></div></div></div></div><h1 class="content-title">Incorporating indel information into phylogeny estimation for rapidly emerging pathogens</h1><div class="half_rhythm"><div class="contrib-group fm-author"><a href="/pubmed/?term=Redelings%20BD%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=17359539" class="affpopup" co-rid="_co_idm140035583998960" co-class="co-affbox">Benjamin D Redelings</a><sup>1</sup> and  <a href="/pubmed/?term=Suchard%20MA%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=17359539" class="affpopup" co-rid="_co_idm140035593630544" co-class="co-affbox">Marc A Suchard</a><sup><img src="/corehtml/pmc/pmcgifs/corrauth.gif" alt="corresponding author" /></sup><sup>2,</sup><sup>3,</sup><sup>4</sup></div><div style="display:none" class="contrib-group aff-tip"><div id="_co_idm140035583998960"><h3 class="no_margin">Benjamin D Redelings</h3><p><sup>1</sup>Bioinformatics Research Center, North Carolina State University, Raleigh, NC 27606 USA </p><div>Find articles by <a href="/pubmed/?term=Redelings%20BD%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=17359539">Benjamin D Redelings</a></div></div><div id="_co_idm140035593630544"><h3 class="no_margin">Marc A Suchard</h3><p><sup>2</sup>Department of Biomathematics, David Geffen School of Medicine at UCLA, Los Angeles, CA 90095 USA </p><p><sup>3</sup>Department of Human Genetics, David Geffen School of Medicine at UCLA, Los Angeles, CA 90095 USA </p><p><sup>4</sup>Department of Biostatistics, UCLA Schoold of Public Health, Los Angeles, CA 90095 USA </p><div>Find articles by <a href="/pubmed/?term=Suchard%20MA%5BAuthor%5D&amp;cauthor=true&amp;cauthor_uid=17359539">Marc A Suchard</a></div></div></div></div><div class="fm-panel half_rhythm"><div class="togglers"><a href="#" class="pmctoggle" rid="idm140035593753872_ai">Author information</a> <a href="#" class="pmctoggle" rid="idm140035593753872_an">Article notes</a> <a href="#" class="pmctoggle" rid="idm140035593753872_cpl">Copyright and License information</a> <a href="/pmc/about/disclaimer/">Disclaimer</a></div><div class="fm-authors-info fm-panel hide half_rhythm" id="idm140035593753872_ai" style="display:none"><div class="fm-affl" lang="en" id="Aff1"><sup>1</sup>Bioinformatics Research Center, North Carolina State University, Raleigh, NC 27606 USA </div><div class="fm-affl" lang="en" id="Aff2"><sup>2</sup>Department of Biomathematics, David Geffen School of Medicine at UCLA, Los Angeles, CA 90095 USA </div><div class="fm-affl" lang="en" id="Aff3"><sup>3</sup>Department of Human Genetics, David Geffen School of Medicine at UCLA, Los Angeles, CA 90095 USA </div><div class="fm-affl" lang="en" id="Aff4"><sup>4</sup>Department of Biostatistics, UCLA Schoold of Public Health, Los Angeles, CA 90095 USA </div><div><span class="fm-affl">Benjamin D Redelings, </span><span class="fm-affl"><span class="email-label">Email: </span><a href="mailto:dev@null" data-email="ude.uscn@sgnileder_nimajneb" class="oemail">ude.uscn@sgnileder_nimajneb</a></span>.</div><div><a href="#idm140035593753872aff-info">Contributor Information</a>.</div><div><sup><img src="/corehtml/pmc/pmcgifs/corrauth.gif" alt="corresponding author" /></sup>Corresponding author.</div></div><div class="fm-article-notes fm-panel hide half_rhythm" id="idm140035593753872_an" style="display:none"><div class="fm-pubdate half_rhythm">Received 2006 Aug 28; Accepted 2007 Mar 14.</div></div><div class="permissions fm-panel half_rhythm hide" id="idm140035593753872_cpl" style="display:none"><div class="fm-copyright half_rhythm"><a href="/pmc/about/copyright/">Copyright</a> &#x000a9; Redelings and Suchard; licensee BioMed Central Ltd. 2007</div><div class="license half_rhythm">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<a href="http://creativecommons.org/licenses/by/2.0" data-ga-action="click_feat_suppl" ref="reftype=extlink&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CFront%20Matter&amp;TO=External%7CLink%7CURI" target="_blank">http://creativecommons.org/licenses/by/2.0</a>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</div></div></div><div id="pmclinksbox" class="links-box whole_rhythm"><div class="fm-panel"><div>This article has been <a href="/pmc/articles/PMC1853084/citedby/">cited by</a> other articles in PMC.</div></div></div></div><div class="sec"></div><div id="Abs1" lang="en" class="tsec sec"><h2 class="head no_bottom_margin" id="Abs1title">Abstract</h2><!--article-meta--><div><div id="__sec1" class="sec sec-first"><h3 id="__sec1title">Background</h3><p id="__p1" class="p p-first-last">Phylogenies of rapidly evolving pathogens can be difficult to resolve because of the small number of substitutions that accumulate in the short times since divergence. To improve resolution of such phylogenies we propose using insertion and deletion (indel) information in addition to substitution information. We accomplish this through joint estimation of alignment and phylogeny in a Bayesian framework, drawing inference using Markov chain Monte Carlo. Joint estimation of alignment and phylogeny sidesteps biases that stem from conditioning on a single alignment by taking into account the ensemble of near-optimal alignments.</p></div><div id="__sec2" class="sec"><h3 id="__sec2title">Results</h3><p id="__p2" class="p p-first-last">We introduce a novel Markov chain transition kernel that improves computational efficiency by proposing non-local topology rearrangements and by block sampling alignment and topology parameters. In addition, we extend our previous indel model to increase biological realism by placing indels preferentially on longer branches. We demonstrate the ability of indel information to increase phylogenetic resolution in examples drawn from within-host viral sequence samples. We also demonstrate the importance of taking alignment uncertainty into account when using such information. Finally, we show that codon-based substitution models can significantly affect alignment quality and phylogenetic inference by unrealistically forcing indels to begin and end between codons.</p></div><div id="__sec3" class="sec"><h3 id="__sec3title">Conclusion</h3><p id="__p3" class="p p-first-last">These results indicate that indel information can improve phylogenetic resolution of recently diverged pathogens and that alignment uncertainty should be considered in such analyses.</p></div><div id="__sec4" class="sec sec-last"><h3 id="__sec4title">Electronic supplementary material</h3><p id="__p4" class="p p-first-last">The online version of this article (doi:10.1186/1471-2148-7-40) contains supplementary material, which is available to authorized users.</p></div></div><div class="sec"><strong class="kwd-title">Keywords: </strong><span class="kwd-text">Severe Acute Respiratory Syndrome, Simian Immunodeficiency Virus, Transition Kernel, Codon Model, Triplet Model</span></div></div><div id="Sec1" class="tsec sec"><h2 class="head no_bottom_margin" id="Sec1title">Background</h2><p id="__p5" class="p p-first">Reconstructing viral phylogenies is important for determining the parent stock of newly emerging strains [<a href="#CR1" rid="CR1" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039490">1</a>], as well as for understanding how viruses evolve over time, both within a single host and at the population level [<a href="#CR2" rid="CR2" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039501">2</a>]. Viral phylogenies are commonly inferred from aligned molecular sequence data, using the information available in substitutions shared by descent [<a href="#CR3" rid="CR3" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039479">3</a>&#x02013;<a href="#CR6" rid="CR6" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039480">6</a>]. Short time-scales dominate in the development of rapidly emerging disease strains, such that the number of observed substitutions between sequences can be too low to yield well-resolved phylogenies. Thus, to increase phylogenetic resolution for such disease strains we seek to make use of a wider class of phylogenetic information.</p><p id="__p6">Insertions and deletions (indels) are a promising category of molecular sequence information that is largely ignored in phylogenetic reconstruction. Researchers commonly remove gaps from molecular sequences alignments by coding them as missing data or by throwing out columns that contain gaps [<a href="#CR3" rid="CR3" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039494">3</a>&#x02013;<a href="#CR6" rid="CR6" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039465">6</a>]. Indels may be useful to resolve deep branches in the Tree of Life that are difficult to resolve using information in shared substitutions [<a href="#CR7" rid="CR7" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039469">7</a>, <a href="#CR8" rid="CR8" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039497">8</a>]. At the other extreme, on which we focus here, indels can help to resolve phylogenies in situations where the number of nucleotide substitutions is inadequate. For example, indels in non-coding chloroplast DNA have been helpful in resolving the branching order of recent plant radiations [<a href="#CR9" rid="CR9" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844967042">9</a>, <a href="#CR10" rid="CR10" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039477">10</a>]. The rate of indel events in these regions approaches or surpasses the rate of substitution, making indels too important to ignore [<a href="#CR10" rid="CR10" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039505">10</a>]. Several species of viruses are also known to accumulate indels, sometimes at a high rate. Cheyner et al. [<a href="#CR11" rid="CR11" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039498">11</a>] note that indel rates are higher than substitution rates in hyper-variable regions of Simian Immunodeficiency Virus (SIV) and Human Immunodeficiency Virus (HIV). Other viruses also experience indels on short time-scales. Hepatitis B virus (HBV) accumulates deletions in the core/pre-core region during the course of infection [<a href="#CR12" rid="CR12" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039507">12</a>], while Equine Infectious Anemia Virus accumulates insertions [<a href="#CR13" rid="CR13" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039516">13</a>]. Three deletion variants of Severe Acute Respiratory Syndrome (SARS) appeared during the beginning of the SARS outbreak in China [<a href="#CR14" rid="CR14" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039474">14</a>]. Influenza B viruses accumulate indels over several decades [<a href="#CR15" rid="CR15" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039481">15</a>]. We note that these viruses are all RNA viruses, with the exception of HBV. Although HBV is a DNA virus, it reverse transcribes its DNA genome from an RNA intermediate.</p><p id="__p7">Redelings and Suchard (2005) describe a statistical method of incorporating indel information into phylogeny estimation. This method uses a joint reconstruction framework that simultaneously infers the alignment, tree, and insertion/deletion rates. Estimation proceeds through Markov chain Monte Carlo (MCMC) within a Bayesian framework and naturally accounts for uncertainty in alignments, phylogenies, and other parameters through posterior probabilities. Unlike sensitivity analysis [<a href="#CR16" rid="CR16" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039514">16</a>, <a href="#CR17" rid="CR17" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039492">17</a>], this approach takes into account uncertainty resulting from the myriad of near-optimal alignments. This approach involves averaging over unobserved quantities such as the alignment and interal node states, which can lead to improved estimates [<a href="#CR18" rid="CR18" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039496">18</a>]. This is different from other approaches which iteratively optimize a heuristically chosen cost function until no improvement is seen [<a href="#CR19" rid="CR19" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039468">19</a>, <a href="#CR20" rid="CR20" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039486">20</a>]. Joint estimation of alignment and phylogeny sidesteps bias that results from conditioning on a single alignment estimate [<a href="#CR21" rid="CR21" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039508">21</a>, <a href="#CR18" rid="CR18" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039515">18</a>], bias which may be exaggerated when indel information is inappropriately used.</p><p id="__p8">This method is based on a probabilistic model of sequence evolution that contains insertion and deletion events as well as substitution events. Heuristic "costs" for opening and extending gaps are replaced by the insertion/deletion rate and the mean indel length respectively, which are biologically interpretable parameters and can be estimated from the data without circularity [<a href="#CR22" rid="CR22" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039484">22</a>, <a href="#CR23" rid="CR23" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039510">23</a>]. Gaps are not treated as a fifth character state, since this overweights the evidence of shared indels by treating an indel of multiple residues as multiple shared indels [<a href="#CR3" rid="CR3" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039482">3</a>]. Instead, the indel process is separate and independent of the substitution process, and allows indels of several residues simultaneously. In addition, because alignments represent positional homology, the indel process does not allow a newly inserted character to be aligned to a previously deleted character.</p><p id="__p9">We introduce a new indel model to remedy a shortcoming of the Redelings and Suchard (RS05) model. Unlike the TKF1 [<a href="#CR22" rid="CR22" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039506">22</a>] and TKF2 [<a href="#CR23" rid="CR23" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039467">23</a>] indel models that are not reversible on pairwise alignments, the reversible RS05 model does not make use of branch length information in the indel process and therefore does not place indels preferentially on longer branches. In order to increase biological realism, we describe an extended indel model that is able to incorporate branch length information. In doing so we overcome a substantial theoretical difficulty in using reversible indel models during phylogenetic reconstruction.</p><p id="__p10">We further enhance the estimation method of Redelings and Suchard [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039473">24</a>] by introducing a novel MCMC transition kernel to improve mixing among topologies. This transition kernel is based on the subtree-prune-and-regraft (SPR) operator but is modified to partially sample the alignment along with the tree. Block sampling improves mixing efficiency because topologies and alignments are highly inter-correlated.</p><p id="__p11">We introduce codon models [<a href="#CR25" rid="CR25" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039471">25</a>] into joint estimation. Codon models are often used in both Bayesian and likelihood-based phylogeny estimation because they naturally allow different rates at the third codon position, but we are not aware of any work using codon models in joint estimation. We note that codon models implicitly alter the indel process as well as the substitution process by forcing indels to begin and end between codons. This constraint may not be biologically realistic and would result in misaligned nucleotides when indels are not in phase with the reading frame. Such misalignment can artificially inflate the number of inferred substitutions. When the total number of substitutions is small, this may significantly alter the model fit or introduce bias. We compare nucleotide and codon indel models to see if these effects are significant.</p><p id="__p12">We analyze data sets from SIV and HIV. The SIV data set consists of a short section of the envelope (<em>env</em>) gene from 9 within-host strains. To see if indel information improves phylogenetic resolution we compare the number of bi-partitions that are supported under the joint model and the traditional sequential approach, in which topology reconstruction assumes a previously determined alignment. We also assess the importance of alignment ambiguity by assessing the sensitivity of phylogeny estimation to fixed alignments under both the traditional and joint models. The HIV data set consists of about 600 nucleotides from the <em>env</em> gene from 27 within-host strains. We compare the number of bi-partitions supported under the sequential and joint models to assess the importance of indel information. We also compare nucleotide and codon models to see if the assumption of unbreakable codons significantly decreases model fit or influences phylogeny estimates.</p><p id="__p13" class="p p-last">In summary, we seek to improve the power to infer clades in rapidly emerging taxa by making use of indel information in a statistically rigorous manner. We also seek to determine whether indels can actually resolve extremely short branches with few substitutions. To accomplish these goals, we introduce an improved statistical model of the insertion-deletion process to improve the accuracy of the inference, and describe a novel MCMC transition kernel to improve the speed of the inference. Once our statistical framework is in place, we then demonstrate that indel information can help to detect previously undetected bi-partitions in two real data examples from RNA viruses. While analyzing these data, we note that alignment ambiguity may significantly affect phylogeny inference. We note that codon-based alignments can unrealistically shift indels to avoid breaking codons, and we develop the necessary statistical machinery to demonstrate that this can substantially affect phylogeny estimates.</p></div><div id="Sec2" class="tsec sec"><h2 class="head no_bottom_margin" id="Sec2title">Results</h2><div id="Sec3" class="sec sec-first"><h3 id="Sec3title">Models and Algorithms</h3><p id="__p14" class="p p-first">We introduce a time-dependent reversible indel process to the probabilistic framework for joint estimation of alignment and phylogeny of Redelings and Suchard [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039485">24</a>]. Time-dependence enables us to place indels preferentially on longer branches of the tree, producing a more realistic description of the evolutionary process. Further, we also introduce a novel MCMC transition kernel to increase topology mixing so that we can estimate phylogenies and alignments containing increasingly more taxa.</p><div id="Sec4" class="sec"><p></p><h4 id="Sec4title" class="inline">Stochastic Model </h4><p id="__p15" class="p p-first">We review the salient features of the RS05 model here and propose the necessary extensions for a time-dependant indel process. Our model starts with data <strong>Y</strong>, where <strong>Y</strong> is a collection of unaligned molecular sequences <strong>Y</strong><sub><em>i</em></sub>for <em>i</em> = 1, ..., <em>n</em> taxa. Each molecular sequence <strong>Y</strong><sub><em>i</em></sub>is a collection of letters of length |<strong>Y</strong><sub><em>i</em></sub>|. We characterize the stochastic model that describes how the sequences in <strong>Y</strong> diverged from a common ancestor in terms of a number of unknown but estimable parameters. These parameters include a multiple alignment <strong>A</strong> that specifies the positional homology between the sequences <strong>Y</strong>, an evolutionary tree (<em>&#x003c4;</em>, <strong>T</strong>) where <em>&#x003c4;</em> is an unrooted bifurcating tree topology and <strong>T</strong> = (<em>t</em><sub>1</sub>, ..., <em>t</em><sub>2<em>N</em> -3</sub>) is a vector of branch lengths along the edges in <em>&#x003c4;</em>, and vectors <strong>&#x00398;</strong> and <strong>&#x0039b;</strong> are parameters that characterize the letter substitution and indel processes respectively. Alignment <strong>A</strong> includes Felsenstein wildcard sequences of random lengths at the internal nodes of <em>&#x003c4;</em>. Thus, <strong>A</strong> also depicts the complete indel history among the sequences in <strong>Y</strong>. We scale branch lengths in terms of expected number of substitutions per site.</p><p id="__p16">In contrast to traditional methods of phylogeny estimation that arbitrarily fix the alignment, we treat the alignment <strong>A</strong> as a random variable, leading to the probability expression</p><p id="__p17">P(<strong>Y</strong>, <strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>) = P(<strong>Y</strong>|<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>) &#x000d7; P(<strong>A</strong>|<em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x0039b;</strong>) &#x000d7; P(<em>&#x003c4;</em>, <strong>T</strong>) &#x000d7; P(<strong>&#x00398;</strong>) &#x000d7; P(<strong>&#x0039b;</strong>). &#x000a0;&#x000a0;&#x000a0; (1)</p><p id="__p18" class="p">The substitution likelihood P(<strong>Y</strong>|<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>) and the priors P(<em>&#x003c4;</em>, <strong>T</strong>) and P(<strong>&#x00398;</strong>) occur in traditional Bayesian models that fix the alignment. However, the alignment prior P(<strong>A</strong>|<em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x0039b;</strong>) and the prior on indel process parameters P(<strong>&#x0039b;</strong>) are novel in the joint model, allowing for estimation and a natural way to handle uncertainty in <strong>A</strong>.</p><div id="Sec5" class="sec"><p></p><h5 id="Sec5title" class="inline">Substitution Model </h5><p id="__p19" class="p p-first">To model the substitution process that specifies P(<strong>Y</strong>|<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>), we assume that substitutions in each column of <strong>A</strong> occur independently and follow a continuous-time Markov chain (CTMC) process [<a href="#CR26" rid="CR26" class=" bibr popnode">26</a>]. Under this process, letters at the root of the tree arise according to some distribution <em>&#x003c0;</em>. Evolution then occurs independently along each branch of <em>&#x003c4;</em> with rate matrix <strong>Q</strong>. We restrict ourselves to reversible Markov chains and use <em>&#x003c0;</em> as the equilibrium distribution of <strong>Q</strong>. This makes the position of the root unidentifiable and so we use unrooted trees throughout this paper.</p><p id="__p20">CTMC models are in common usage for letters from nucleotide-, codon-, and amino acid-based alphabets. In contrast to nucleotide-based CTMC models, codon-based models group the three nucleotides in a codon into a single letter. Given the small number of substitutions that occur during the emergence of rapidly evolving pathogens, codon-based models are preferred over amino-acid based models because they do not discard synonymous substitutions. Codon-based models can also improve model efficiency over nucleotide-based models because the codon-based models can include non-independent nucleotide frequencies and rule out missense mutations [<a href="#CR25" rid="CR25" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039502">25</a>]. Codon-based models may also improve the accuracy of estimation by allowing the third-codon position to evolve at a higher rate. However, when the number of observed substitutions is low it may not be possible to estimate the non-synonymous to synonymous rate ratio <em>&#x003c9;</em>, requiring researchers to fix <em>&#x003c9;</em> to a previously estimated value.</p><p id="__p21" class="p p-last">Importantly, we note that codon-based models also affect the indel process by forbidding frameshift mutations and also indels that begin or end within a codon. While the former constraint is realistic for biologically active viruses, the latter constraint may force incorrect alignments at the nucleotide level, causing up to two misaligned residues per indel. This may result in a significant bias when the total number of substitutions is small.</p></div><div id="Sec6" class="sec sec-last"><p></p><h5 id="Sec6title" class="inline">Indel Models </h5><p id="__p22" class="p p-first">Redelings and Suchard [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039499">24</a>] make the simplifying assumption that the alignment prior</p><p id="__p23">P(<strong>A</strong>|<em>&#x003c4;</em>,<strong>T</strong>,<strong>&#x0039b;</strong>) = P(<strong>A</strong>|<em>&#x003c4;</em>, <strong>&#x0039b;</strong>) &#x000a0;&#x000a0;&#x000a0; (2)</p><p id="__p24">is independent of branch lengths. While this assumption implies that indels are equally likely to occur on each branch regardless of length, it trivially enforces that sequence length distributions <em>&#x003c6;</em> on all nodes in <em>&#x003c4;</em> remain the same. This is a necessary condition for constructing a reversible evolutionary Hidden Markov model (HMM) from pair-HMMs along the branches of <em>&#x003c4;</em>. Reversibility substantially decreases implementation complexity. The assumption further allows us to avoid fragment based pair-HMMs that tend to separate indels by the average indel length, which is not necessarily biologically realistic.</p><p id="__p25">Here we develop an alignment prior P(<strong>A</strong>|<em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x0039b;</strong>) that explicitly depends on branch lengths but retains equivalent sequence length distributions on all nodes of the tree. We begin construction of the extended model by briefly summarizing how the original indel model is constructed from a pairwise alignment distribution <em>&#x003bd;</em>. We modify this construction to build the new indel model from a parameterized distribution <em>&#x003bd;</em><sub><em>t</em></sub>on pairwise alignments that corresponds to a divergence time <em>t</em>. We then describe a new pair-HMM which serves to generate <em>&#x003bd;</em><sub><em>t</em></sub>. Finally we describe how to calculate posterior probabilities under this model.</p><p id="__p26">To describe our original multiple alignment model, we begin by noting that, given a topology <em>&#x003c4;</em>, the multiple alignment <strong>A</strong> can be decomposed into a set of pairwise alignments <strong>A</strong><sup>(<em>b</em>)</sup>along each branch <em>b</em> of the topology. This decomposition is possible because of the inclusion of Felsenstein wildcard sequences at the internal nodes of <em>&#x003c4;</em>. Imposing an arbitrary distribution <em>&#x003bd;</em> on each pairwise alignment <strong>A</strong><sup>(<em>b</em>)</sup>independently yields a joint distribution over <strong>A</strong>. However, pairwise alignments on neighboring branches are not strictly independent because they both specify the length of the random sequence at the node they share. To handle this dependence, we first choose an arbitrary internal node in <em>&#x003c4;</em> as the root; this imposes an orientation on each branch. We then label the sequence in each branch alignment <strong>A</strong><sup>(<em>b</em>)</sup>that is closest to the root as the ancestral sequence and the other sequence as the descendant sequence. We sample the sequence length at the root from a distribution <span id="IEq1"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1"><semantics><mover accent="true"><mi>&#x003c6;</mi><mo>&#x002dc;</mo></mover><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFgpGzgaacaaaa@2E7B@</annotation></semantics></math></span> and draw the pairwise alignment <strong>A</strong><sup>(<em>b</em>)</sup>for each branch <em>b</em> from <em>&#x003bd;</em> conditional on the length of the ancestral sequence, proceeding down the tree from the root to the leaves.</p><p id="__p27">We note that the pairwise alignment distribution <em>&#x003bd;</em> induces a sequence length distribution on each sequence in the pair it emits. To proceed, we require that the pairwise alignment distribution <em>&#x003bd;</em> be symmetric under interchange of the two sequences in the pair. This implies that there is no preferred direction of evolution between the two sequences. It also implies that the sequence length distribution for the ancestral and descendant sequences are equal; we call this common distribution <em>&#x003c6;</em>. If we set the root length distribution <span id="IEq2"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2"><semantics><mover accent="true"><mi>&#x003c6;</mi><mo>&#x002dc;</mo></mover><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFgpGzgaacaaaa@2E7B@</annotation></semantics></math></span> = <em>&#x003c6;</em>, then we can write the multiple alignment prior as</p><p id="__p28">\n<span id="IEq3"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3"><semantics><mrow><mtext>P</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>|</mo><mi>&#x003c4;</mi><mo>,</mo><mi>&#x0039b;</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mstyle displaystyle="true"><msubsup><mo>&#x0220f;</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><mi>B</mi></msubsup><mrow><msub><mtext>P</mtext><mi>&#x003bd;</mi></msub><mo stretchy="false">(</mo><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mrow><mrow><mstyle displaystyle="true"><msub><mo>&#x0220f;</mo><mrow><mi>i</mi><mo>&#x02208;</mo><mi>I</mi></mrow></msub><mrow><mi>&#x003c6;</mi><msup><mrow><mo stretchy="false">(</mo><mo>|</mo><msub><mi>A</mi><mi>i</mi></msub><mo>|</mo><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mstyle></mrow></mfrac><mo>,</mo><mrow><mo>(</mo><mn>3</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGqbaucqGGOaakieqacqWFbbqqcqGG8baFiiGacqGFepaDcqGGSaaliiqacqqFBoatcqGGPaqkcqGH9aqpdaWcaaqaamaaradabaGaeeiuaa1aaSbaaSqaaiab+17aUbqabaGccqGGOaakcqWFbbqqdaahaaWcbeqaaiabcIcaOiabdkgaIjabcMcaPaaakiabcMcaPaWcbaGaemOyaiMaeyypa0JaeGymaedabaGaemOqaieaniabg+Givdaakeaadaqeqaqaaiab+z8aMjabcIcaOiabcYha8jab=feabnaaBaaaleaacqWGPbqAaeqaaOGaeiiFaWNaeiykaKYaaWbaaSqabeaacqaIYaGmaaaabaGaemyAaKMaeyicI4SaemysaKeabeqdcqGHpis1aaaakiabcYcaSiaaxMaacaWLjaWaaeWaaeaacqaIZaWmaiaawIcacaGLPaaaaaa@5B20@</annotation></semantics></math></span>\n</p><p id="__p29">where <em>I</em> represents the set of internal nodes in <em>&#x003c4;</em> [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039500">24</a>]. Note that in this expression the arbitrary root is not identifiable.</p><p id="__p30">Unfortunately the parameters that characterize our original pairwise alignment distribution <em>&#x003bd;</em> can not vary from branch to branch without inducing unequal length distributions. We therefore propose a new pairwise alignment prior that maintains a fixed sequence length distribution <em>&#x003c6;</em> even when the indel probability varies from branch to branch. To accomplish this aim, we assume that each sequence consists of a series of unbreakable fragments, as in the TKF2 model. The fragment lengths are geometrically distributed with continuation probability <em>&#x003b5;</em> and minimum length 1. The number of fragments is uniformly distributed over the non-negative integers. Following an ancestral fragment at one end of a branch, a geometric number of new fragments are inserted in the descendent with continuation probability <em>&#x003b4;</em>(<em>t</em>). Each ancestral fragment survives in the descendent with probability <em>&#x003b4;\'</em>(<em>t</em>) = <em>&#x003b4;</em>(<em>t</em>)/(1 - <em>&#x003b4;</em>(<em>t</em>)). Following our previous model and the TKF models, insertions and deletions are equally likely.</p><p id="__p31">This model can be expressed as a symmetrical pair-HMM (Figure <a href="/pmc/articles/PMC1853084/figure/Fig1/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig1" rid-ob="ob-Fig1" co-legend-rid="lgnd_Fig1"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure1),</span></span><span>1</span></a>), implying that alignments can be considered non-directed, since the probability does not change when ancestor and descendant sequences are interchanged. This contrasts with the TKF models that induce irreversible distributions on pairwise alignments. A major advantage of this symmetry is that it is clear how to construct alignment models on an unrooted tree and leads to greater simplicity in model implementation and, arguably, decreased computation time. The model described here diverges from our previous model in that match fragments no longer contain only a single letter, but instead follow the same length distribution as gap fragments. This is represented graphically in the pair-HMM by the addition of a loop with non-zero weight <em>&#x003b5;</em> from the match state (+/+) to itself.</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig1" co-legend-rid="lgnd_Fig1"><a href="/pmc/articles/PMC1853084/figure/Fig1/" target="figure" rid-figpopup="Fig1" rid-ob="ob-Fig1"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035588992896" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig1_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig1_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig1_HTML.jpg" /></div><div id="largeobj_idm140035588992896" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig1/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig1"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig1/" target="figure" rid-figpopup="Fig1" rid-ob="ob-Fig1">Figure 1</a></div><!--caption a7--><div class="caption"><p id="__p32"><strong>Pair-HMM representation of the fragment-based indel model</strong>. After the start state (S), the Markov chain transitions to the central silent state. From here it may terminate by transitioning to the end state (E), or it may enter a match (+/+), insert (-/+) or delete (+/-) fragment. Each fragment has probability <em>&#x003b4;</em>(<em>t</em>) of being an insert or delete fragment. Fragment lengths are geometric with continuation probability <em>&#x003b5;</em>. After the end of a fragment, the Markov chain returns to the central silent state where it may begin a new fragment. The silent state that indicates fragment boundaries can be removed, resulting in transitions only between non-silent states. The model is a fragment based model because the direct transition probability from (+/+) to (+/+) without going through the silent state is <em>&#x003b5;</em> and not 0. The pair-HMM represents an improper distribution because the probabilities of outgoing edges of the central silent state do not sum to 1.</p></div></div></div><p id="__p33">To facilitate dependence of pairwise alignment distribution <em>&#x003bd;</em><sub><em>t</em></sub>on <em>t</em>, we seek a natural relationship between <em>&#x003b4;</em>(<em>t</em>) and <em>t</em>. We define <em>&#x003bb;</em> as the indel rate per residue scaled in terms of substitution time and refer to the pairwise alignment distribution on branch <em>b</em> as <span id="IEq4"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4"><semantics><mrow><msup><mi>&#x003bd;</mi><mrow><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msub><mi>&#x003bd;</mi><mrow><mi>&#x003bb;</mi><msub><mi>t</mi><mi>b</mi></msub></mrow></msub></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWF9oGBdaahaaWcbeqaaiabcIcaOiabdkgaIjabcMcaPaaakiabg2da9iab=17aUnaaBaaaleaacqWF7oaBcqWG0baDdaWgaaadbaGaemOyaigabeaaaSqabaaaaa@392B@</annotation></semantics></math></span>. The parameter <em>&#x003b5;</em> remains independent of time. In our previous model, we measure the occurrence probability of indels on a per-residue basis. In the fragment-based model, <em>&#x003b4;\'</em>(<em>t</em>) becomes the probability of a fragment being inserted or deleted. We wish to re-parameterize the fragment model in terms of a per-residue indel rate; the probability of an indel occurring between two residues is (1 - <em>&#x003b5;</em>)<em>&#x003b4;\'</em>(<em>t</em>). However, if we attempt to set</p><p id="__p34">\n<span id="IEq5"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>&#x02212;</mo><mi>&#x003b5;</mi><mo stretchy="false">)</mo><msup><mi>&#x003b4;</mi><mo>&#x02032;</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>&#x02212;</mo><msup><mi>e</mi><mrow><mo>&#x02212;</mo><mi>&#x003bb;</mi><msub><mi>t</mi><mi>b</mi></msub></mrow></msup><mo>,</mo><mrow><mo>(</mo><mn>4</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqGGOaakcqaIXaqmcqGHsisliiGacqWF1oqzcqGGPaqkcuWF0oazgaqbaiabcIcaOiabdsha0jabcMcaPiabg2da9iabigdaXiabgkHiTiabdwgaLnaaCaaaleqabaGaeyOeI0Iae83UdWMaemiDaq3aaSbaaWqaaiabdkgaIbqabaaaaOGaeiilaWIaaCzcaiaaxMaadaqadaqaaiabisda0aGaayjkaiaawMcaaaaa@454F@</annotation></semantics></math></span>\n</p><p id="__p35">then the probability <em>&#x003b4;\'</em>(<em>t</em>) can become greater than 1. We therefore move the factor of (1 - <em>&#x003b5;</em>) into the time scale, such that</p><p id="__p36">\n<span id="IEq6"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6"><semantics><mrow><msup><mi>&#x003b4;</mi><mo>&#x02032;</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>&#x02212;</mo><msup><mi>e</mi><mrow><mo>&#x02212;</mo><mfrac><mrow><mi>&#x003bb;</mi><msub><mi>t</mi><mi>b</mi></msub></mrow><mrow><mn>1</mn><mo>&#x02212;</mo><mi>&#x003b5;</mi></mrow></mfrac></mrow></msup><mo>.</mo><mrow><mo>(</mo><mn>5</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWF0oazgaqbaiabcIcaOiabdsha0jabcMcaPiabg2da9iabigdaXiabgkHiTiabdwgaLnaaCaaaleqabaGaeyOeI0YaaSaaaeaacqWF7oaBcqWG0baDdaWgaaadbaGaemOyaigabeaaaSqaaiabigdaXiabgkHiTiab=v7aLbaaaaGccqGGUaGlcaWLjaGaaCzcamaabmaabaGaeGynaudacaGLOaGaayzkaaaaaa@43BE@</annotation></semantics></math></span>\n</p><p id="__p37">We note that Equation (4) agrees with Equation (5) to first order in <em>&#x003bb;t</em><sub><em>b</em></sub>and serves to connect fragment indel rates to per-residue indel rates. The product <em>&#x003bb;t</em><sub><em>b</em></sub>is in general &#x0226a; 1, so matching on higher order terms is unnecessary.</p><p id="__p38">The distribution <em>&#x003bd;</em><sub><em>t</em></sub>naturally gives rise to two models. In the first model, denoted "fragments", we set <em>&#x003bd;</em><sup>(<em>b</em>)</sup>= <em>&#x003bd;</em><sub><em>&#x003bb;</em></sub>for all <em>b</em>, making the probability f an indel independent of branch length again. In the second model, denoted as "fragments+<em>T</em>", we set <span id="IEq7"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7"><semantics><mrow><msup><mi>&#x003bd;</mi><mrow><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msub><mi>&#x003bd;</mi><mrow><mi>&#x003bb;</mi><msub><mi>t</mi><mi>b</mi></msub></mrow></msub></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWF9oGBdaahaaWcbeqaaiabcIcaOiabdkgaIjabcMcaPaaakiabg2da9iab=17aUnaaBaaaleaacqWF7oaBcqWG0baDdaWgaaadbaGaemOyaigabeaaaSqabaaaaa@392B@</annotation></semantics></math></span> making the probability of an indel roughly proportional to branch length <em>t</em><sub><em>b</em></sub>.</p><p id="__p39">We now show that the sequence length distribution induced by <em>&#x003bd;</em><sub><em>t</em></sub>is independent of <em>t</em>. The pairwise alignment distribution is a uniform distribution on the number of fragments, with each fragment being a match (+/+), insertion (-/+) or deletion (+/-) with probabilities 1 - 2<em>&#x003b4;</em>(<em>t</em>), <em>&#x003b4;</em>(<em>t</em>) and <em>&#x003b4;</em>(<em>t</em>), respectively, and with exit measure (1 - <em>&#x003b4;</em>(<em>t</em>)). This results in the following probability generating function for the length of either sequence in the pair-HMM:</p><p id="__p40">\n<span id="IEq8"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>1</mn><mo>&#x02212;</mo><mi>&#x003b5;</mi></mrow><mrow><mn>1</mn><mo>&#x02212;</mo><mi>s</mi></mrow></mfrac><mo>+</mo><mi>&#x003b5;</mi><mo>.</mo><mrow><mo>(</mo><mn>6</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGMbGzcqGGOaakcqWGZbWCcqGGPaqkcqGH9aqpdaWcaaqaaiabigdaXiabgkHiTGGaciab=v7aLbqaaiabigdaXiabgkHiTiabdohaZbaacqGHRaWkcqWF1oqzcqGGUaGlcaWLjaGaaCzcamaabmaabaGaeGOnaydacaGLOaGaayzkaaaaaa@403E@</annotation></semantics></math></span>\n</p><p id="__p41" class="p p-last">Therefore, the length distribution is independent of <em>&#x003b4;</em>(<em>t</em>), and is uniform except for an anomaly at length 0. This allows us to specify a different value of <em>&#x003b4;</em>(<em>t</em>) in the pair-HMM on each branch of the tree without affecting <em>&#x003c6;</em>. Defining <em>L</em><sub>1</sub> and <em>L</em><sub>2</sub> as the emitted sequence lengths from the pair-HMM, we note that <em>P</em>(<em>L</em><sub>1</sub> = <em>l</em><sub>1</sub>) has finite measure and that the distribution <em>P</em>(<em>L</em><sub>2</sub> = <em>l</em><sub>2</sub>|<em>L</em><sub>1</sub> = <em>l</em><sub>1</sub>) on <em>L</em><sub>2</sub> is therefore proper. This implies that the posterior distribution of the joint model is proper because the distribution conditions on the observed leaf sequence lengths.</p></div></div><div id="Sec7" class="sec"><p></p><h4 id="Sec7title" class="inline">Sampling </h4><p id="__p42" class="p p-first">We introduce a novel MCMC transition kernel that improves mixing between topologies and alignments. The new transition kernel uses the SPR operator (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2)</span></span><span>2</span></a>) to propose new trees, but is extended to be alignment-aware. Our previous approach used only nearest-neighbor-interchange (NNI) operators to propose new trees [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039483">24</a>]. This resulted in long convergence times and inefficient mixing when there were many taxa. The SPR operator improves on this situation by proposing non-local topology rearrangements that would require several NNI moves, and thus avoids several intermediates [<a href="#CR27" rid="CR27" class=" bibr popnode">27</a>].</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig2" co-legend-rid="lgnd_Fig2"><a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" rid-figpopup="Fig2" rid-ob="ob-Fig2"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035586144880" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig2_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig2_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig2_HTML.jpg" /></div><div id="largeobj_idm140035586144880" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig2/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig2"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" rid-figpopup="Fig2" rid-ob="ob-Fig2">Figure 2</a></div><!--caption a7--><div class="caption"><p id="__p43"><strong>The subtree-prune-and-regraft operator</strong>. (a) First a subtree (blue) and its associated node O are detached from the rest of the tree (green). (b) The subtree is then regrafted along into a different branch through its node O. In both (a) and (b), three branches connect to node O. The phylogeny relating sequences at the pruned nodes (blue) and the phylogeny relating sequences at the remaining nodes (green) do not change. Therefore alignments within each of these sequence subsets can remain unchanged from (a) to (b).</p></div></div></div><p id="__p44">The extended SPR transition kernel updates the alignment <strong>A</strong> along with the topology <em>&#x003c4;</em>. In our framework, it is necessary to alter <strong>A</strong> when <em>&#x003c4;</em> is altered because <strong>A</strong> specifies the homology of internal sequences and this homology may be inconsistent with the proposed topology. This happens when some column of <strong>A</strong> contains a letter that would be deleted and reinserted given the new topology. After an SPR tree proposal, we note that the alignment of the subset of sequences corresponding to taxa in the pruned subtree (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2,</span></span><span>2</span></a>, blue) must remain consistent because their phylogeny remains unchanged. Likewise, the alignment of the other sequences (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2,</span></span><span>2</span></a>, green) must remain consistent because the phylogeny of that subset remains unchanged. However the alignment of the complete set of sequences may not be consistent.</p><p id="__p45">Our solution to this problem involves collapsed Gibbs sampling [<a href="#CR28" rid="CR28" class=" bibr popnode">28</a>] of <strong>A</strong> as follows. We define the collapsed point (*, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>)<sub><em>C</em></sub>as the set of points {(<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>) : <strong>A</strong> &#x02208; <em>C</em>} for some set <em>C</em>. The posterior probability of a collapsed point is then naturally defined as the posterior probability of the set. When proposing a new tree (<em>&#x003c4;\'</em>, <strong>T</strong>\n<em>\'</em>) via SPR from the current point (<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>), we first use a Metropolis-Hasting (MH) transition kernel to choose between the collapsed points (*, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>)<sub><em>C</em></sub>and (*, <em>&#x003c4;\'</em>, <strong>T</strong>\n<em>\'</em>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>)<sub><em>C</em></sub>. This avoids the problem of <strong>A</strong> being inconsistent with <em>&#x003c4;\'</em> as long as <em>C</em> is large enough to contain alignments consistent with both <em>&#x003c4;</em> and <em>&#x003c4;\'</em>. Then we sample a single point from the chosen collapsed point in proportion to its posterior probability. To satisfy detailed balance, the set <em>C</em> must be constructed so that it contains at least the current alignment <strong>A</strong>; full conditions under which this procedure satisfies detailed balance are described in the Appendix.</p><p id="__p46" class="p p-last">We now seek a set <em>C</em> that is large enough to contain alignments consistent with <em>&#x003c4;\'</em> and yet small enough for integration and sampling to be computationally feasible. Unfortunately, integration over the set of all alignments is not practical, even if we constrain the alignment of leaf sequences to be constant. Therefore, we fix parts of the alignment and collapse only the remaining portions. Allowing only the three branch alignments adjacent to node O (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2)</span></span><span>2</span></a>) to vary will certainly allow an alignment consistent with <em>&#x003c4;\'</em>. This is therefore a loose constraint, which we call <em>C</em><sub>3</sub>(<strong>A</strong>, <em>&#x003c4;</em>, <strong>O</strong>). It requires an <em>O</em>(<em>L</em><sup>3</sup>) dynamic programming algorithm for integration and resampling. To decrease the order of the dynamic programming algorithm to <em>O</em>(<em>L</em><sup>1</sup>), we consider imposing the additional constraint, which we call <em>C</em><sub>1</sub>(<strong>A</strong>, <em>&#x003c4;</em>, <strong>O</strong>), that the alignments between the three nodes connected to <strong>O</strong> remain fixed. However, this constraint is too tight because it forces all sequences in the subtree (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2,</span></span><span>2</span></a>, hatched) to keep the same alignment with the remaining sequences, and may not include any alignments consistent with <em>&#x003c4;\'</em>. As an alternative, we propose to fix the alignment between sequences in the pruned subtree and the alignment between sequences in the remainder, but allow the alignment between the two groups of sequences to vary. This constraint, which we call <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, OP) results in an <em>O</em>(<em>L</em><sup>2</sup>) algorithm that is significantly more computationally efficient than an <em>O</em>(<em>L</em><sup>3</sup>) algorithm. Note that we have demonstrated above that the alignment within the two subgroups of sequences remains consistent under an SPR proposal. Thus, the constraint set <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, OP) contains an alignment that is consistent with <em>&#x003c4;\'</em> as well as <em>&#x003c4;</em>, making <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, OP) a useful constraint set for collapsed sampling.</p></div><div id="Sec8" class="sec sec-last"><p></p><h4 id="Sec8title" class="inline">Triplet Models </h4><p id="__p47" class="p p-first">Triplet models coalesce three adjacent nucleotide letters into a single triplet letter. The size of the triplet alphabet is therefore approximately the cube of the size of the singlet alphabet. The larger alphabet size allows a more complex substitution model such as the codon model of Goldman and Yang [[<a href="#CR25" rid="CR25" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039464">25</a>], M0]. Triplet substitution models can prohibit stop codons, can make use of codon frequencies instead of nucleotide frequencies and can differentiate between synonymous and non-synonymous substitutions. Triplet alphabets affect the alignment model as well as the substitution model by forcing indels lengths to be multiples of 3 singlet letters and by forcing indels to start and end between triplets. While the former is biologically realistic, the latter may not be.</p><p id="__p48">We describe a method of comparing triplet with singlet models to assess how forcing indels to begin and end between codons affects model fit. To accomplish this, we first remove the substitution benefits of the M0 model listed above to focus solely on the effects of the triplet alignment process. We construct a triplet substitution model that generates the same likelihood as a singlet substitution model given the same alignment. Traditionally, both models are reversible and have a rate matrix <strong>Q</strong> = {<em>Q</em><sub><em>xy</em></sub>} that is constructed from the equilibrium letter frequencies <em>&#x003c0;</em> and a symmetric exchangeability matrix <strong>S</strong> = {<em>S</em><sub><em>xy</em></sub>} in the following way:</p><p id="__p49">\n<span id="IEq9"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9"><semantics><mrow><msub><mi>Q</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><msub><mi>S</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mfrac><mrow><msubsup><mi>&#x003c0;</mi><mi>y</mi><mi>f</mi></msubsup></mrow><mrow><msubsup><mi>&#x003c0;</mi><mi>x</mi><mrow><mn>1</mn><mo>&#x02212;</mo><mi>f</mi></mrow></msubsup></mrow></mfrac><mo>.</mo><mrow><mo>(</mo><mn>7</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaWgaaWcbaGaemiEaGNaemyEaKhabeaakiabg2da9iabdofatnaaBaaaleaacqWG4baEcqWG5bqEaeqaaOWaaSaaaeaaiiGacqWFapaCdaqhaaWcbaGaemyEaKhabaGaemOzaygaaaGcbaGae8hWda3aa0baaSqaaiabdIha4bqaaiabigdaXiabgkHiTiabdAgaMbaaaaGccqGGUaGlcaWLjaGaaCzcamaabmaabaGaeG4naCdacaGLOaGaayzkaaaaaa@4682@</annotation></semantics></math></span>\n</p><p id="__p50">Fraction <em>f</em> can vary from 0 to 1 but traditionally <em>f</em> is fixed to 1. The fraction specifies the relative importance of unequal conservation (<em>f</em> = 0) and unequal replacement (<em>f</em> = 1) in creating the equilibrium frequency distribution [<a href="#CR29" rid="CR29" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039491">29</a>].</p><p id="__p51">Given a singlet nucleotide model with exchangeability matrix <strong>S</strong><sup>(<em>s</em>)</sup>, we build a triplet model with exchangeability matrix <strong>S</strong><sup>(<em>t</em>)</sup>in the following fashion. Each allowable substitution from triplet <em>&#x003b1;</em> to triplet <em>&#x003b2;</em> involves only one nucleotide substitution from nucleotide <em>i</em> to nucleotide <em>j</em>. Therefore, we set <span id="IEq10"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10"><semantics><mrow><msubsup><mi>S</mi><mrow><mi>&#x003b1;</mi><mi>&#x003b2;</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaqhaaWcbaacciGae8xSdeMae8NSdigabaGaeiikaGIaemiDaqNaeiykaKcaaOGaeyypa0Jaem4uam1aa0baaSqaaiabdMgaPjabdQgaQbqaaiabcIcaOiabdohaZjabcMcaPaaaaaa@3CB2@</annotation></semantics></math></span> in this case, and <span id="IEq11"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11"><semantics><mrow><msubsup><mi>S</mi><mrow><mi>&#x003b1;</mi><mi>&#x003b2;</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaqhaaWcbaacciGae8xSdeMae8NSdigabaGaeiikaGIaemiDaqNaeiykaKcaaaaa@346D@</annotation></semantics></math></span> = 0 for all other entries. If the singlet model is, for example, the model of Hasegawa et al. [[<a href="#CR30" rid="CR30" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844967043">30</a>], HKY], we term the resulting triplet model as HKY &#x000d7; 3. We also set the triplet frequencies <span id="IEq12"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12"><semantics><mrow><msubsup><mi>&#x003c0;</mi><mi>&#x003b1;</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCdaqhaaWcbaGae8xSdegabaGaeiikaGIaemiDaqNaeiykaKcaaaaa@335A@</annotation></semantics></math></span> for each triplet <em>&#x003b1;</em> composed of nucleotides <em>i</em>, <em>j</em> and <em>k</em> to the product <span id="IEq13"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13"><semantics><mrow><msubsup><mi>&#x003c0;</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCdaqhaaWcbaGaemyAaKgabaGaeiikaGIaem4CamNaeiykaKcaaOGae8hWda3aa0baaSqaaiabdQgaQbqaaiabcIcaOiabdohaZjabcMcaPaaakiab=b8aWnaaDaaaleaacqWGRbWAaeaacqGGOaakcqWGZbWCcqGGPaqkaaaaaa@3FF5@</annotation></semantics></math></span> of the individual nucleotide frequencies.</p><p id="__p52">Although this construction might be expected to yield a triplet substitution model that is identical to the singlet substitution model, this is not the case if <em>f</em> = 1. For an allowable substitution <em>ijk</em> &#x02192; <em>ijl</em>, we note that the rate <span id="IEq14"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14"><semantics><mrow><msubsup><mi>Q</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaqhaaWcbaGaemyAaKMaemOAaOMaem4AaSMaeiilaWIaemyAaKMaemOAaOMaemiBaWgabaGaeiikaGIaemiDaqNaeiykaKcaaaaa@3A37@</annotation></semantics></math></span> according to the triplet model does not match the rate <span id="IEq15"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15"><semantics><mrow><msubsup><mi>Q</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi>S</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>l</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaqhaaWcbaGaem4AaSMaemiBaWgabaGaeiikaGIaem4CamNaeiykaKcaaOGaeyypa0Jaem4uam1aa0baaSqaaiabdUgaRjabdYgaSbqaaiabcIcaOiabdohaZjabcMcaPaaaiiGakiab=b8aWnaaDaaaleaacqWGSbaBaeaacqGGOaakcqWGZbWCcqGGPaqkaaaaaa@42AF@</annotation></semantics></math></span> according to the singlet model. Specifically,</p><p id="__p53">\n<span id="IEq16"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16"><semantics><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msubsup><mi>Q</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msubsup><mi>S</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mrow><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msubsup><mi>S</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>l</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mo>&#x02260;</mo></mtd><mtd columnalign="left"><mrow><msubsup><mi>Q</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>.</mo></mrow></mtd></mtr></mtable><mrow><mo>(</mo><mn>8</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeWadaaabaGaemyuae1aa0baaSqaaiabdMgaPjabdQgaQjabdUgaRjabcYcaSiabdMgaPjabdQgaQjabdYgaSbqaaiabcIcaOiabdsha0jabcMcaPaaaaOqaaiabg2da9aqaaiabdofatnaaDaaaleaacqWGPbqAcqWGQbGAcqWGRbWAcqGGSaalcqWGPbqAcqWGQbGAcqWGSbaBaeaacqGGOaakcqWG0baDcqGGPaqkaaacciGccqWFapaCdaqhaaWcbaGaemyAaKMaemOAaOMaemiBaWgabaGaeiikaGIaemiDaqNaeiykaKcaaaGcbaaabaGaeyypa0dabaGaem4uam1aa0baaSqaaiabdUgaRjabdYgaSbqaaiabcIcaOiabdohaZjabcMcaPaaakiab=b8aWnaaDaaaleaacqWGPbqAaeaacqGGOaakcqWGZbWCcqGGPaqkaaGccqWFapaCdaqhaaWcbaGaemOAaOgabaGaeiikaGIaem4CamNaeiykaKcaaOGae8hWda3aa0baaSqaaiabdYgaSbqaaiabcIcaOiabdohaZjabcMcaPaaaaOqaaaqaaiabgcMi5cqaaiabdgfarnaaDaaaleaacqWGRbWAcqWGSbaBaeaacqGGOaakcqWGZbWCcqGGPaqkaaGccqGGUaGlaaGaaCzcaiaaxMaadaqadaqaaiabiIda4aGaayjkaiaawMcaaaaa@7B7C@</annotation></semantics></math></span>\n</p><p id="__p54">The rates do not match because the rate of change from <em>k</em> &#x02192; <em>l</em> in the triplet model depends on the frequencies of the other nucleotides in the triplet. Since this is not true in the singlet model, the likelihoods under each model cannot match unless all the nucleotide frequencies are equal.</p><p id="__p55">However, removing the constraint that <em>f</em> = 1, it becomes possible for the two models to coalesce because the rate of change <span id="IEq17"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17"><semantics><mrow><msubsup><mi>Q</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaqhaaWcbaGaemyAaKMaemOAaOMaem4AaSMaeiilaWIaemyAaKMaemOAaOMaemiBaWgabaGaeiikaGIaemiDaqNaeiykaKcaaaaa@3A37@</annotation></semantics></math></span> can be independent of the frequencies of <em>i</em> and <em>j</em>. Setting <em>f</em> = <span id="IEq18"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabikdaYaaaaaa@2E9E@</annotation></semantics></math></span>, the frequencies of neighboring nucleotides no longer affect the rate of change from <em>k</em> &#x02192; <em>l</em>, as</p><p id="__p56">\n<span id="IEq19"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19"><semantics><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msubsup><mi>Q</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msubsup><mi>S</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mo>,</mo><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><msqrt><mrow><mfrac><mrow><msubsup><mi>&#x003c0;</mi><mrow><mi>i</mi><mi>j</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><mrow><msubsup><mi>&#x003c0;</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mrow></msqrt></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msubsup><mi>S</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msqrt><mrow><mfrac><mrow><msubsup><mi>&#x003c0;</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>l</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><mrow><msubsup><mi>&#x003c0;</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>&#x003c0;</mi><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mrow></msqrt><mo>=</mo><msubsup><mi>S</mi><mrow><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup><msqrt><mrow><mfrac><mrow><msubsup><mi>&#x003c0;</mi><mi>l</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><mrow><msubsup><mi>&#x003c0;</mi><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mrow></msqrt><mo>.</mo></mrow></mtd></mtr></mtable><mrow><mo>(</mo><mn>9</mn><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeGadaaabaGaemyuae1aa0baaSqaaiabdMgaPjabdQgaQjabdUgaRjabcYcaSiabdMgaPjabdQgaQjabdYgaSbqaaiabcIcaOiabdsha0jabcMcaPaaaaOqaaiabg2da9aqaaiabdofatnaaDaaaleaacqWGPbqAcqWGQbGAcqWGRbWAcqGGSaalcqWGPbqAcqWGQbGAcqWGSbaBaeaacqGGOaakcqWG0baDcqGGPaqkaaGcdaGcaaqaamaalaaabaacciGae8hWda3aa0baaSqaaiabdMgaPjabdQgaQjabdYgaSbqaaiabcIcaOiabdsha0jabcMcaPaaaaOqaaiab=b8aWnaaDaaaleaacqWGPbqAcqWGQbGAcqWGRbWAaeaacqGGOaakcqWG0baDcqGGPaqkaaaaaaqabaaakeaaaeaacqGH9aqpaeaacqWGtbWudaqhaaWcbaGaem4AaSMaemiBaWgabaGaeiikaGIaem4CamNaeiykaKcaaOWaaOaaaeaadaWcaaqaaiab=b8aWnaaDaaaleaacqWGPbqAaeaacqGGOaakcqWGZbWCcqGGPaqkaaGccqWFapaCdaqhaaWcbaGaemOAaOgabaGaeiikaGIaem4CamNaeiykaKcaaOGae8hWda3aa0baaSqaaiabdYgaSbqaaiabcIcaOiabdohaZjabcMcaPaaaaOqaaiab=b8aWnaaDaaaleaacqWGPbqAaeaacqGGOaakcqWGZbWCcqGGPaqkaaGccqWFapaCdaqhaaWcbaGaemOAaOgabaGaeiikaGIaem4CamNaeiykaKcaaOGae8hWda3aa0baaSqaaiabdUgaRbqaaiabcIcaOiabdohaZjabcMcaPaaaaaaabeaakiabg2da9iabdofatnaaDaaaleaacqWGRbWAcqWGSbaBaeaacqGGOaakcqWGZbWCcqGGPaqkaaGcdaGcaaqaamaalaaabaGae8hWda3aa0baaSqaaiabdYgaSbqaaiabcIcaOiabdohaZjabcMcaPaaaaOqaaiab=b8aWnaaDaaaleaacqWGRbWAaeaacqGGOaakcqWGZbWCcqGGPaqkaaaaaaqabaGccqGGUaGlaaGaaCzcaiaaxMaadaqadaqaaiabiMda5aGaayjkaiaawMcaaaaa@A46D@</annotation></semantics></math></span>\n</p><p id="__p57" class="p p-last">We note that for branch lengths to agree between the singlet and triplet models, <strong>Q</strong><sup>(<em>t</em>)</sup>must be scaled so that <span id="IEq20"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20"><semantics><mrow><mstyle displaystyle="true"><msub><mo>&#x02211;</mo><mrow><mi>&#x003b1;</mi><mo>&#x02260;</mo><mi>&#x003b2;</mi></mrow></msub><mrow><msubsup><mi>&#x003c0;</mi><mi>&#x003b1;</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>Q</mi><mrow><mi>&#x003b1;</mi><mi>&#x003b2;</mi></mrow><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mstyle></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaaeqaqaaGGaciab=b8aWnaaDaaaleaacqWFXoqyaeaacqGGOaakcqWG0baDcqGGPaqkaaGccqWGrbqudaqhaaWcbaGae8xSdeMae8NSdigabaGaeiikaGIaemiDaqNaeiykaKcaaaqaaiab=f7aHjabgcMi5kab=j7aIbqab0GaeyyeIuoaaaa@41EA@</annotation></semantics></math></span> instead of the usual 1, because <strong>Q</strong><sup>(<em>t</em>)</sup>measures changes of each of the three sites in the triplet. We use HKY as the singlet model in our comparison because the HKY &#x000d7; 3 model is identical to the M0 codon model with <em>&#x003c9;</em> = 1, stop codons included, and independent nucleotide frequencies.</p></div></div><div id="Sec9" class="sec"><h3 id="Sec9title">Examples</h3><p id="__p58" class="p p-first">We analyze two data examples to demonstrate the advantages of joint Bayesian estimation. While both data sets come from related genes, they differ in their sequence lengths, number of taxa, and sequence characteristics. We select these datasets for their relative sparseness of phylogenetic information, typical of rapidly evolving pathogens. Thus, although the joint model makes full use of both indels and substitutions shared by descent, we do not expect to recover fully resolved trees. Rather, we note substantial improvement over traditional, sequential methods.</p><div id="Sec10" class="sec"><p></p><h4 id="Sec10title" class="inline">Example 1: SIV </h4><p id="__p59" class="p p-first">We first examine a data set drawn from SIV, a non-human primate lentivirus. Lentiviruses contain a single-stranded RNA genome that reverse transcribes into DNA by upon infection. The DNA then inserts into the host genome before expression. Reverse transcriptase is extremely error-prone, giving lentiviruses high mutation rates. The data set consists of 9 partial <em>env</em> sequences sampled from within a single macaque initially infected by injection with strain SIVmac251 [<a href="#CR31" rid="CR31" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039488">31</a>]. Cheynier et al (2001) have previously presented an alignment of these sequences as a typical example of phylogenetically informative indels in SIV [<a href="#CR11" rid="CR11" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039504">11</a>].</p><p id="__p60">The <em>env</em> gene encodes glycoprotein gp160, which is split after translation to form the smaller glycoproteins gp120 and gp41. Because gp120 and gp41 are displayed on the surface of mature virions, exposed to the host immune system, <em>env</em> tends to mutate more quickly than other SIV genes through positive selection. From the data set, we remove a phylogenetically uninformative duplication in a single sequence because our model assumes insertions of random sequence but not duplications. All sequences then range in length from 57 to 69 nucleotides with an alignment length of 69 nucleotides independent of the method used to compute the fixed alignment. The data set contains 10 variable sites and 6 informative sites under the Clustal W alignment, 12 variable and 7 informative sites under the Muscle alignment, and 11 variable and 6 informative sites under the MAP estimate from the joint model (Table <a href="/pmc/articles/PMC1853084/table/Tab1/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab1" rid-ob="ob-Tab1" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table1,</span></span><span>1</span></a>, &#x02013; Indel contribution).</p><!--table ft1--><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="Tab1"><h3>Table 1</h3><!--caption a7--><div class="caption"><p id="__p61">Phylogenetic resolution of various models in SIV.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035583948848" class="xtable"><table frame="hsides" rules="groups" class="rendered small default_table"><thead><tr><th align="center" rowspan="2" colspan="1">Model</th><th align="center" rowspan="2" colspan="1">&#x000c2;</th><th align="center" colspan="2" rowspan="1"># sites</th><th align="center" colspan="3" rowspan="1">#/6 with PP</th><th align="center" colspan="3" rowspan="1">Estimates</th></tr><tr><th align="center" rowspan="1" colspan="1">var.</th><th align="center" rowspan="1" colspan="1">inf.</th><th align="center" rowspan="1" colspan="1">&#x0003e; 0.90</th><th align="center" rowspan="1" colspan="1">&#x0003e; 0.95</th><th align="center" rowspan="1" colspan="1">&#x0003e; 0.99</th><th align="center" rowspan="1" colspan="1">\n<em>&#x003ba;</em>\n</th><th align="center" rowspan="1" colspan="1">ln <em>&#x003bb;</em></th><th align="center" rowspan="1" colspan="1">ln <em>&#x003b5;</em></th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">- Indel</td><td align="center" rowspan="1" colspan="1">Clustal W</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">6</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">2.3(1.6,4.9)</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1"></td><td align="center" rowspan="1" colspan="1">Muscle</td><td align="center" rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">7</td><td align="center" rowspan="1" colspan="1">4</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">2.2(1.5,4.3)</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1"></td><td align="center" rowspan="1" colspan="1">MAP</td><td align="center" rowspan="1" colspan="1">11</td><td align="center" rowspan="1" colspan="1">6</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">2.4(1.6,5.2)</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">-</td></tr><tr><td align="center" rowspan="1" colspan="1">+ Indel</td><td align="center" rowspan="1" colspan="1">Clustal W</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">6</td><td align="center" rowspan="1" colspan="1">3+1</td><td align="center" rowspan="1" colspan="1">3+1</td><td align="center" rowspan="1" colspan="1">2+1</td><td align="center" rowspan="1" colspan="1">2.3(1.6,4.7)</td><td align="center" rowspan="1" colspan="1">-2.7(-4.5,-1.4)</td><td align="center" rowspan="1" colspan="1">-0.61(-0.93,-0.37)</td></tr><tr><td rowspan="1" colspan="1"></td><td align="center" rowspan="1" colspan="1">Muscle</td><td align="center" rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">7</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">2</td><td align="center" rowspan="1" colspan="1">2.3(1.6,4.4)</td><td align="center" rowspan="1" colspan="1">-3.5(-5.0,-2.1)</td><td align="center" rowspan="1" colspan="1">-0.92(-1.5,-0.55)</td></tr><tr><td rowspan="1" colspan="1"></td><td align="center" rowspan="1" colspan="1">MAP</td><td align="center" rowspan="1" colspan="1">11</td><td align="center" rowspan="1" colspan="1">6</td><td align="center" rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">4</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">2.4(1.6,5.1)</td><td align="center" rowspan="1" colspan="1">-3.4(-5.0,-1.9)</td><td align="center" rowspan="1" colspan="1">-0.71(-1.1,-0.43)</td></tr><tr><td align="center" rowspan="1" colspan="1">Joint</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">4</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">2.4(1.6,5.3)</td><td align="center" rowspan="1" colspan="1">-3.4(-5.0,-1.9)</td><td align="center" rowspan="1" colspan="1">-0.71(-1.1,-0.43)</td></tr></tbody></table></div><div id="largeobj_idm140035583948848" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/table/Tab1/?report=objectonly">Open in a separate window</a></div><div class="tblwrap-foot"><p id="__p62">Results are presented for the traditional sequential model (- Indel), the joint model with a fixed alignment (+ Indel), and the full joint model. The choice of a fixed alignment estimate is indicated in column <strong>&#x000c2;</strong> if applicable. The number of variable and informative sites is indicated under "#sites" and varies depending on the choice of alignment. The number of supported internal branches out of a possible 6 is reported at three levels of posterior probability (PP). The designation "+1" indicates that 1 of the supported branches conflicts with a branch supported under the joint model. Estimates of continuous parameters <em>&#x003ba;</em>, ln <em>&#x003bb;</em>, and ln <em>&#x003b5;</em> are presented as a posterior median followed by a 95% Bayesian credible interval.</p></div></div><p id="__p63">For a prior on ln <em>&#x003ba;</em>, we assume a Double-Exponential distribution with median ln 2 and standard deviation <span id="IEq21"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabisda0aaaaaa@2EA2@</annotation></semantics></math></span>. On ln <em>&#x003bb;</em>, we assume a Double-Exponential distribution with median -5 and standard deviation <span id="IEq22"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabikdaYaaaaaa@2E9E@</annotation></semantics></math></span>. For <em>&#x003b5;</em> we assume an Exponential distribution with mean 5 on the expected indel length. We assume a Uniform distribution over the topology <em>&#x003c4;</em>. On the branch lengths we assume an Exponential distribution with mean <em>&#x003bc;</em>, and on <em>&#x003bc;</em> we assume an Exponential distribution with mean 0.04. Continuous parameter estimates under the joint model are as follows: <em>&#x003ba;</em> has median 2.4 with a 95% Bayesian credible interval of (1.64,5.32). The median of ln <em>&#x003bb;</em> is -3.4 and its 95% BCI is (-4.99, -1.85). The median of ln <em>&#x003b5;</em> is -0.71 with a 95% BCI of (-1.12, -0.428). The mean branch length <em>&#x003bc;</em>, has posterior median 0.0178 with a 95% BCI of (0.00854,0.0368).</p><p id="__p64">To assess the usefulness of indel information and the importance of alignment ambiguity in phylogenetic inference, we compare the posterior topology distributions for the traditional sequential model, the joint model restricted to a fixed alignment, and the full joint model. We note that the joint model increases the number of resolved internal branches by 3, 2, and 2 at posterior probability (PP) &#x0003e; 0.9, &#x0003e; 0.95, and &#x0003e; 0.99, respectively, over the traditional model using the Clustal W alignment. The joint model supports 4, 3, and 3 branches at these levels of posterior probability and we depict the tree with branches supported at PP &#x0003e; 0.99 in Figure <a href="/pmc/articles/PMC1853084/figure/Fig3/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig3" rid-ob="ob-Fig3" co-legend-rid="lgnd_Fig3"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">Figure3.</span></span><span>3</span></a>. This increase in resolution is sensitive to the alignment estimation method. For example, the resolution increase changes to 0, 0, and 2 under the Muscle alignment, and 1, 2, 2 under the joint MAP alignment. Thus, even accounting for alignment uncertainty, we achieve an increase in the phylogenetic resolution. At high posterior probabilities indels become relatively more important because they are rarer than substitutions.</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig3" co-legend-rid="lgnd_Fig3"><a href="/pmc/articles/PMC1853084/figure/Fig3/" target="figure" rid-figpopup="Fig3" rid-ob="ob-Fig3"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035592890320" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig3_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig3_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig3_HTML.jpg" /></div><div id="largeobj_idm140035592890320" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig3/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig3"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig3/" target="figure" rid-figpopup="Fig3" rid-ob="ob-Fig3">Figure 3</a></div><!--caption a7--><div class="caption"><p id="__p65"><strong>Indel information improves resolution of the SIV phylogeny</strong>. (a) At posterior probability &#x0003e; 0.99 the traditional sequential model supports only one branch, (b) When indel information is included, the number of supported branches rises to 3. The two green branches are supported only when indel information is used.</p></div></div></div><p id="__p66" class="p p-last">We note that alignment ambiguity is significant in this data set. First, estimates under the traditional or restricted models are sensitive to the alignment method used (Table <a href="/pmc/articles/PMC1853084/table/Tab1/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab1" rid-ob="ob-Tab1" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table1).</span></span><span>1</span></a>). Second, fixing the alignment under the joint model yields an increase in the number of supported branches if the alignment is fixed to the Clustal W estimate or the joint MAP estimate, but a decrease if the Muscle estimate is used. Furthermore, the increased support when the Clustal W alignment is used includes a branch that conflicts with the joint MAP model, and the conflicting branch is present in the guide tree. Thus ignoring alignment ambiguity can lead to exaggerated support for branches and bias towards the guide tree, especially when indel information is used. Figure <a href="/pmc/articles/PMC1853084/figure/Fig4/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig4" rid-ob="ob-Fig4" co-legend-rid="lgnd_Fig4"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">Figure4</span></span><span>4</span></a> displays a "gold" plot [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039509">24</a>] to summarize the posterior alignment distribution of <strong>A</strong> under the full joint model. We observe a high level of alignment uncertainty. This is borne out by the observation of only 4 unique indels under the full joint model, while the Clustal W alignment contains 5 indels. This difference is reflected in the lower estimate of <em>&#x003bb;</em> under the full joint model and in the restricted models not using the Clustal W alignment (Table <a href="/pmc/articles/PMC1853084/table/Tab1/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab1" rid-ob="ob-Tab1" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table1</span></span><span>1</span></a>).</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig4" co-legend-rid="lgnd_Fig4"><a href="/pmc/articles/PMC1853084/figure/Fig4/" target="figure" rid-figpopup="Fig4" rid-ob="ob-Fig4"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035594172752" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig4_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig4_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig4_HTML.jpg" /></div><div id="largeobj_idm140035594172752" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig4/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig4"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig4/" target="figure" rid-figpopup="Fig4" rid-ob="ob-Fig4">Figure 4</a></div><!--caption a7--><div class="caption"><p id="__p67"><strong>SIV Alignment uncertainty plot</strong>. We annotate the joint maximum a posteriori alignment estimate to indicate the approximate probability that each letter aligns to the root taxon in its column [24]. The 8 gaps in the alignment are a result of only 4 indel events under the joint model, whereas the Clustal W alignment requires at least 5 indel events. Colors other than red indicates that letters or gaps may shift to adjacent positions. The high frequency of the CAA triplet is partially responsible for the level of alignment uncertainty.</p></div></div></div></div><div id="Sec11" class="sec sec-last"><p></p><h4 id="Sec11title" class="inline">Example 2: HIV-1 </h4><p id="__p68" class="p p-first">Our second data set consists of comparatively longer sequences from HIV-1, a lentivirus closely related to SIV. We consider a collection of 27 partial <em>env</em> gene sequences sampled serially at three time points from patient 1 reported by Shankarappa et al [<a href="#CR4" rid="CR4" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039476">4</a>]. Each sequence name consists of a unique identifying number prefixed by the number of weeks after infection that the sequence was sampled. For the sake of brevity we drop the prefix and use only the unique identifier, except where explicity noted. The sequences span HIV genome reference sites 7023&#x02013;7637 and include about 280 nucleotides of gp120, covering the V3 loop, followed by 330 nucleotides of gp41. Sequence lengths vary from 603 to 612 nucleotides. The number of homologous sites depends on the method used to compute the fixed alignment. Using the alignment from the MAP point or the Muscle alignment, this data set contains 621 columns, of which 76 are variable and 25 are informative. The Clustal W estimate generates an alignment of 618 columns, of which 77 are variable and 25 are informative.</p><div id="Sec12" class="sec"><p></p><h5 id="Sec12title" class="inline">Sequence Characteristics </h5><p id="__p69" class="p p-first">We first analyze these data using the M0 codon model [<a href="#CR25" rid="CR25" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039472">25</a>] to assess the importance of selection in this region (Table <a href="/pmc/articles/PMC1853084/table/Tab2/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab2" rid-ob="ob-Tab2" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table2).</span></span><span>2</span></a>). We use the same prior distributions on <em>&#x003bb;</em>, <em>&#x003b5;</em>, <em>&#x003ba;</em>, <em>&#x003c4;</em>, and <strong>T</strong> as in Example 1. We additionally place a Double-Exponential distribution on ln <em>&#x003c9;</em> with median 0 and standard deviation 0.1. In addition to the standard M0 model in which <em>f</em> is fixed to 1, we consider the case in which <em>f</em> is a random variable with a Uniform prior distribution. The posterior distribution of <em>&#x003c9;</em> has median 0.996 and a 95% BCI of (0.834,1.20). This changes little when <em>f</em> is free. The estimated interval is quite close to the prior 95% BCI of (0.84,1.16) so we conclude that these data possess little information about <em>&#x003c9;</em>. Allowing <em>&#x003c9;</em> to vary does not yield much benefit, and we henceforth consider only <em>&#x003c9;</em> = 1.</p><!--table ft1--><!--table-wrap mode="anchored" t5--><div class="table-wrap table anchored whole_rhythm" id="Tab2"><h3>Table 2</h3><!--caption a7--><div class="caption"><p id="__p70">Comparison of alignment and substitution models.</p></div><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035584435632" class="xtable"><table frame="hsides" rules="groups" class="rendered small default_table"><thead><tr><th align="center" rowspan="1" colspan="1">Model</th><th align="center" rowspan="1" colspan="1">ln P(Y)</th><th align="center" rowspan="1" colspan="1">\n<em>&#x003ba;</em>\n</th><th align="center" rowspan="1" colspan="1">ln <em>&#x003bb;</em></th><th align="center" rowspan="1" colspan="1">ln <em>&#x003b5;</em></th><th align="center" rowspan="1" colspan="1">\n<em>&#x003c9;</em>\n</th><th align="center" rowspan="1" colspan="1">\n<em>f</em>\n</th><th align="center" rowspan="1" colspan="1">(10,12,18)</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1">HKY</td><td align="center" rowspan="1" colspan="1">-1555.7</td><td align="center" rowspan="1" colspan="1">7.2(4.6,11.7)</td><td align="center" rowspan="1" colspan="1">-3.3(-4.1,-2.7)</td><td align="center" rowspan="1" colspan="1">-1.0(-1.3,-0.78)</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">0.5</td><td align="center" rowspan="1" colspan="1">0.96(25)</td></tr><tr><td align="center" rowspan="1" colspan="1">HKY &#x000d7; 3</td><td align="center" rowspan="1" colspan="1">-1579.8</td><td align="center" rowspan="1" colspan="1">7.5(4.8,12.2)</td><td align="center" rowspan="1" colspan="1">-2.3(-3.1,-1.6)</td><td align="center" rowspan="1" colspan="1">-2.7(-3.7,-1.9)</td><td align="center" rowspan="1" colspan="1">-</td><td align="center" rowspan="1" colspan="1">0.5</td><td align="center" rowspan="1" colspan="1">0.75(3.1)</td></tr><tr><td align="center" rowspan="1" colspan="1">M0</td><td align="center" rowspan="1" colspan="1">-1542.7</td><td align="center" rowspan="1" colspan="1">7.2(4.6,11.8)</td><td align="center" rowspan="1" colspan="1">-2.2(-3.0,-1.6)</td><td align="center" rowspan="1" colspan="1">-2.7(-3.7,-1.9)</td><td align="center" rowspan="1" colspan="1">1.0(0.86,1.2)</td><td align="center" rowspan="1" colspan="1">0.46(0.26,0.65)</td><td align="center" rowspan="1" colspan="1">0.92(12)</td></tr></tbody></table></div><div id="largeobj_idm140035584435632" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/table/Tab2/?report=objectonly">Open in a separate window</a></div><div class="tblwrap-foot"><p id="__p71">We compare the HKY singlet model, the HKY &#x000d7; 3 triplet model, and the M0 codon model, that forbids stop codons. For the first two models we fix independent nucleotide frequencies but for the M0 model we allow codon frequencies to vary. Continuous parameter estimates are presented as a posterior median followed by a 95% Bayesian credible interval if free, and a single value if fixed. The HKY model has a higher marginal probability than the HKY &#x000d7; 3 triplet model, indicating that not all indels start and end between codons. Removing stop codons and allowing codon frequencies to vary freely increases the marginal likelihood of the M0 model substantially. Despite these increases in marginal likelihood, the M0 model does not support the clade (10,12,18) as well as the singlet model.</p></div></div><p id="__p72">We also note that fixing <em>f</em> = <span id="IEq23"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabikdaYaaaaaa@2E9E@</annotation></semantics></math></span> instead of the traditional value of 1 produces a decrease in marginal likelihood of 2 log units for the HKY model and a substantial increase of 5 log units for the HKY &#x000d7; 3 model (Table <a href="/pmc/articles/PMC1853084/table/Tab2/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab2" rid-ob="ob-Tab2" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table2).</span></span><span>2</span></a>). When <em>f</em> varies under the M0 model, the resulting model is supported over the <em>f</em> = 1 model by 7 log units of marginal likelihood. In addition, the posterior median of <em>f</em> is 0.43, close to the value of <span id="IEq24"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabikdaYaaaaaa@2E9E@</annotation></semantics></math></span> that is used to compare the HKY and HKY &#x000d7; 3 models. We therefore assume <em>f</em> = 0.5 for the remainder of our analyses.</p><p id="__p73" class="p p-last">Under the HKY model we find that <em>&#x003ba;</em> has a posterior median of 7.2 with a 95% BCI of (4.6,11.7). The posterior median of ln <em>&#x003bb;</em> is -3.3 with a 95% BCI of (-4.1, -2.7) and ln <em>&#x003b5;</em> has a median of -1.0 and a 95% BCI of (-1.3, -0.78). This estimate of <em>&#x003b5;</em> corresponds to a mean indel length of 1.58 nucleotides. The posterior median of <em>&#x003bc;</em>, is 0.0036 with a 95% BCI of (0.00257,0.00508).</p></div><div id="Sec13" class="sec"><p></p><h5 id="Sec13title" class="inline">Singlet versus Triplet models </h5><p id="__p74" class="p p-first">To examine the model appropriateness of forcing indels to begin and end between codons, we compared the marginal likelihoods and posterior tree lengths for the HKY singlet and HKY &#x000d7; 3 triplet models. Under both models, we fixed <em>f</em> = <span id="IEq25"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabikdaYaaaaaa@2E9E@</annotation></semantics></math></span> for equivalence and set independent nucleotide frequencies to their empirical estimates. The log marginal likelihood is -1555.7 &#x000b1; 0.3 for the singlet model and -1579.8 &#x000b1; 0.3 for the triplet model (Table <a href="/pmc/articles/PMC1853084/table/Tab2/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab2" rid-ob="ob-Tab2" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table2).</span></span><span>2</span></a>). To examine the substantial decrease of 24.1 log units between models, we calculate the posterior distribution of parsimony tree lengths under both models. The posterior median tree length is 104 substitutions with a 95% BCI of (103,106) for the singlet model and increases to 109 substitutions with a 95% BCI of (108,110) for the triplet model. To verify that this increase results from forcing indels out of phase, we first calculate the posterior distribution of the number of indels under the singlet model. The posterior mean number of indels is 11.0 and the BCI is (11,11). The posterior mean number of indels beginning 0, 1, or 2 nucleotides from the beginning of a codon is 2.6, 5.8, and 2.6 respectively. The 95% BCI for the number of indels beginning inside a codon is (6,10). Inspecting the alignment estimate from the MAP point using a "gold" plot demonstrates alignment uncertainty (data not shown). In the MAP alignment we observe 11 indel events. Only 5 of the indels are consistently present with unambiguous phase, and none of these indels can be placed between codons. Interestingly, one indel of 3 nucleotides occurs independently in clades (16,17), 19, and 22 according to the MAP estimate (Figure <a href="/pmc/articles/PMC1853084/figure/Fig5/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig5" rid-ob="ob-Fig5" co-legend-rid="lgnd_Fig5"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure5).</span></span><span>5</span></a>). We note that augmented alignments such as those used in our model distinguish between indels shared by state and indel shared by descent through the inclusion of Felsenstein wildcard sequences at internal nodes of <em>&#x003c4;</em>.</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig5" co-legend-rid="lgnd_Fig5"><a href="/pmc/articles/PMC1853084/figure/Fig5/" target="figure" rid-figpopup="Fig5" rid-ob="ob-Fig5"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035584716928" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig5_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig5_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig5_HTML.jpg" /></div><div id="largeobj_idm140035584716928" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig5/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig5"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig5/" target="figure" rid-figpopup="Fig5" rid-ob="ob-Fig5">Figure 5</a></div><!--caption a7--><div class="caption"><p id="__p75"><strong>Triplet alignments may shift indels and cause misaligned residues</strong>. Triplet alignments may shift indels and cause misaligned residues. (a) Maximum a posteriori (MAP) alignment estimate under the singlet HKY model. (b) MAP alignment estimate under the triplet HKY &#x000d7; 3 model. In the triplet alignment, two G residues (blue) and four A residues (red) are forced into a different column to avoid breaking the alignment-wide reading frame. The displaced A residues join A residues from strains 10, 12, and 18 (green) which were previously the only A residues in that column. Under both models, the MAP alignment estimates display 8 gaps. The alignment of internal sequences (not shown) indicates that these gaps arose from 5 indel events on branches partitioning clades (20,23), (21,24), (16,17), (19), and (22). Thus, the gaps in sequences 19 and 22 arose independently of the gap in (16,17) even though they have the same length and position. Prefixes on sequence names indicate elapsed time in weeks between the initial infection and when the sequences were obtained.</p></div></div></div><p id="__p76">Use of the triplet model instead of the singlet model has a discernible effect on phylogeny estimation. The posterior odds in favor of the clade (10,12,18) decrease by a factor of 8.0 from 24.6 to 3.1 (Table <a href="/pmc/articles/PMC1853084/table/Tab2/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab2" rid-ob="ob-Tab2" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table2).</span></span><span>2</span></a>). We note that in one column of the singlet MAP alignment estimate, only variants 10, 12 and 18 have an A residue, while other taxa have either a G residue or a gap (Figure <a href="/pmc/articles/PMC1853084/figure/Fig5/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig5" rid-ob="ob-Fig5" co-legend-rid="lgnd_Fig5"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure5a).</span></span><span>5a</span></a>). However, the triplet model shifts these gaps out of the column to avoid breaking a codon. Taxa that contain a gap in this column under the singlet alignment contain A residues according to the triplet MAP alignment, decreasing the support for (10,12,18) clade (Figure <a href="/pmc/articles/PMC1853084/figure/Fig5/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig5" rid-ob="ob-Fig5" co-legend-rid="lgnd_Fig5"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure5b).</span></span><span>5b</span></a>). Thus, comparing marginal likelihoods for model selection between the singlet and triplet models may not provide the whole picture.</p><p id="__p77" class="p p-last">Triplet models have discernible effects on estimates of the indel parameters <em>&#x003bb;</em> and <em>&#x003b5;</em>, but little effect on the substitution parameters <em>&#x003bc;</em> and <em>&#x003ba;</em>. For example, under the HKY &#x000d7; 3 model the posterior median of <em>&#x003bb;</em> is <em>e</em><sup>-2.3</sup>, about 3 times higher than the posterior median of <em>e</em><sup>-3.3</sup> under the HKY model. We note that under the HKY &#x000d7; 3 model <em>&#x003bb;</em> is the indel rate per triplet, whereas under the singlet model <em>&#x003bb;</em> is the indel rate per nucleotide. This factor of 3 difference is to be expected since the number of indels does not change between the two models, but the number of triplets is 3 times smaller than the number of nucleotides. The HKY &#x000d7; 3 model also results in a posterior median estimate of -2.6 for ln <em>&#x003b5;</em> that is significantly smaller than the HKY estimate of -1.0. However, accounting for the fact that one triplet contains three nucleotides, the HKY &#x000d7; 3 model predicts a mean indel length of 1.1 triplets and 3.2 nucleotides, but the HKY model predicts a mean indel length of 1.6 nucleotides. This may be because a geometric distribution on the number of nucleotides in a gap does not fit the data as well as a geometric distribution on the number of triplets in a gap. This is especially true in data sets such as the present one in which the number of triplets tends to be small. It may also be because the indel model used is fragment-based. Finally, we note that estimates of 7.5 for <em>&#x003ba;</em> in the HKY &#x000d7; 3 model are quite similar to estimates of about 7.2 under the HKY model.</p></div><div id="Sec14" class="sec sec-last"><p></p><h5 id="Sec14title" class="inline">Increased support due to indel information </h5><p id="__p78" class="p p-first">To assess how much indel information improves the resolution of the HIV phylogeny, we generate posterior samples under both the traditional, sequential model and under the full joint model. The traditional model supports 8, 7 and 4 internal branches at PP levels &#x0003e; 0.90, &#x0003e; 0.95, and &#x0003e; 0.99, respectively regardless of the chosen fixed alignment. The MAP topology is also insensitive to the chosen alignment. Under the full joint model the number of supported internal branches increases to 8, 8, and 6 branches at the same levels of PP, producing an increase of 0, 1, and 2 branches.</p><p id="__p79" class="p p-last">While the number of branches supported at PP &#x0003e; 0.9 is equal, not all supported branches are the same. The number of branches supported only under the joint model is 2, 2, and 2. The joint model supports the clades (16,17) and (21,24) over the traditional model at all three levels of PP. The traditional model supports the clade (19,21,24,25) at a PP of 0.980 compared to 0.887 with indel information. The traditional model also supports the clade (10,12,15,16,18,19,21,24,25) at PP &#x0003e; 0.9 that has support &#x0003c; 0.5 when indel information is included. This results because the large clade conflicts with the clade (16,17) that is supported by two shared indels. Thus, the number of branches supported in only one of the two models at each level of PP is 4, 3, and 2. Since the joint model balances substitution and indel information as well as taking alignment ambiguity into account we assume that these differences represent an improvement in the accuracy of estimation. However, because the true tree is not observed, we cannot be certain which, if any, of the predictions is correct. The partitions supported under the two models at PP &#x0003e; 0.99 are depicted in Figure <a href="/pmc/articles/PMC1853084/figure/Fig6/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig6" rid-ob="ob-Fig6" co-legend-rid="lgnd_Fig6"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">Figure6.</span></span><span>6</span></a>. In summary, indel information conflicts with one branch in the substitution-only tree and down-weights the evidence for another branch. The conflicting branch is ruled out by the support of 2 shared indels for the clade (16,17), although one of these is homoplastic.</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig6" co-legend-rid="lgnd_Fig6"><a href="/pmc/articles/PMC1853084/figure/Fig6/" target="figure" rid-figpopup="Fig6" rid-ob="ob-Fig6"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035588663584" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig6_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig6_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig6_HTML.jpg" /></div><div id="largeobj_idm140035588663584" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig6/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig6"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig6/" target="figure" rid-figpopup="Fig6" rid-ob="ob-Fig6">Figure 6</a></div><!--caption a7--><div class="caption"><p id="__p80"><strong>Triplet alignments may shift indels and cause misaligned residues</strong>. (a) At posterior probability &#x0003e; 0.99 the traditional sequential model supports 4 internal branches. (b) When indel information is included, the number of supported branches increases to 6. Branches colored green are supported only when indel information is incorporated. Each blue cross denotes an indel event occurring on a particular branch. Prefixes on sequence names indicate elapsed time in weeks between the initial infection and when the sequences were obtained.</p></div></div></div></div></div></div><div id="Sec15" class="sec sec-last"><h3 id="Sec15title">MCMC Improvements</h3><p id="__p81" class="p p-first">We demonstrate that the novel MCMC transition kernel introduced in the sub-section <em>Sampling</em> improves the computational efficiency of topology estimation when using indel information. The transition kernel improves the convergence properties of the Markov chain substantially, so that fewer initial samples must be discarded as "burn-in". We compare the behavior of the estimation procedure when the new transition kernel is disabled (NNI-only) or enabled (NNI+SPR) by running 15 instances of each chain starting from a randomly chosen tree and alignment. We use the data-set from Example 2 that consists of 27 HIV sequences, with a maximum length 612 nucleotides.</p><p id="__p82">To assess convergence for each Markov chain, we count the number of iterations required for the sampled tree topology to approach its equilibrium distribution of tree topologies. To accomplish this task, we need to define a distance from a single tree topology to a distibution of tree topologies. We start with the Robinson-Foulds distance (RF) between two tree topologies that we denote as <em>d</em><sub>RF</sub>(<em>&#x003c4;</em><sub>1</sub>, <em>&#x003c4;</em><sub>2</sub>). This distance does not depend on branch lengths. We then define the distance <em>d</em>(<em>&#x003c4;</em><sub>1</sub>, <em>&#x003be;</em>) from a topology <em>&#x003c4;</em><sub>1</sub> to a distribution of topologies <em>&#x003be;</em> as the average RF distance between <em>&#x003c4;</em><sub>1</sub> and a tree <em>&#x003c4;</em><sub>2</sub> ~ <em>&#x003be;</em>:</p><p id="__p83"><em>d</em>(<em>&#x003c4;</em><sub>1</sub>, <em>&#x003be;</em>) = E{<em>d</em><sub>RF</sub>(<em>&#x003c4;</em><sub>1</sub>, <em>&#x003c4;</em><sub>2</sub>)}. &#x000a0;&#x000a0;&#x000a0; (10)</p><p id="__p84">The expectation of <em>d</em>(<em>&#x003c4;</em><sub>1</sub>, <em>&#x003be;</em>) does not converge to 0 as the Markov chain approaches stationarity; rather the expectation approaches the average distance between two trees sampled from the equilibrium topology distribution. With this in mind, we consider a chain to have converged when the distance from the chain\'s current topology to the equilibrium distribution reaches the lower 25th percentile of distances from trees at stationarity to the equilibrium distribution. We approximate the equilibrium topology distribution with 200 topologies sampled at widely spaced intervals from a long-running MCMC analysis. We find that this distribution is not sensitive to the starting point of the Markov chain, and does not change when the new transition kernel is enabled.</p><p id="__p85" class="p p-last">Without the new transition kernel based on SPR, the median time to convergence is 2112 iterations with an average of 1976.9. However, when the new transition kernel is enabled, the median time decreases to 66 iterations, and the average shrinks to 108.8 iterations. In addition, without the SPR transition kernel, the two slowest converging chains take 3887 and 6782 iterations to converge, whereas with the SPR transition kernel the two slowest converging chains require only 248 and 422 iterations to converge. Based on the average time until convergence, we calculate that the SPR transition kernel results in a roughly 18.1-fold increase in convergence speed, although we emphasize that the convergence times vary substantially around their average. The faster-converging chains spend about 2 &#x000d7; as much CPU time per iteration, leading to an effective speed-up of about 9-fold. To visualize the convergence properties of the two approaches, we project the tree samples from two typical chains into the plane using metric multidimensional scaling based on their RF distances (Figure <a href="/pmc/articles/PMC1853084/figure/Fig7/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig7" rid-ob="ob-Fig7" co-legend-rid="lgnd_Fig7"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure7</span></span><span>7</span></a>).</p><!--fig ft0--><!--fig mode=article f1--><div class="fig iconblock whole_rhythm clearfix" id="Fig7" co-legend-rid="lgnd_Fig7"><a href="/pmc/articles/PMC1853084/figure/Fig7/" target="figure" rid-figpopup="Fig7" rid-ob="ob-Fig7"><!--fig/graphic|fig/alternatives/graphic mode="anchored" m1--><div data-largeobj="" data-largeobj-link-rid="largeobj_idm140035585339760" class="figure"><img class="fig-image" alt="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig7_HTML.jpg" title="An external file that holds a picture, illustration, etc.&#10;Object name is 12862_2006_Article_334_Fig7_HTML.jpg" src="/pmc/articles/PMC1853084/bin/12862_2006_Article_334_Fig7_HTML.jpg" /></div><div id="largeobj_idm140035585339760" class="largeobj-link align_right" style="display: none"><a target="object" href="/pmc/articles/PMC1853084/figure/Fig7/?report=objectonly">Open in a separate window</a></div></a><div class="icnblk_cntnt" id="lgnd_Fig7"><div><a class="figpopup" href="/pmc/articles/PMC1853084/figure/Fig7/" target="figure" rid-figpopup="Fig7" rid-ob="ob-Fig7">Figure 7</a></div><!--caption a7--><div class="caption"><p id="__p86"><strong>Alignment-aware SPR transition kernel decreases burn-in time</strong>. We consider the 27-sequence data set of HIV sequences described in the Results section as Example 2. Points represent 200 topologies sampled from a Markov chains with the alignment-aware SPR transition kernel disabled (red; NNI-only) or enabled (blue; NNI+SPR) or from the equilibrium distribution (green). While the convergence time for Markov chains varies widely, this example illustrates the median convergence time. The NNI-only chain takes 2112 iterations to converge versus only 66 iterations for the NNI+SPR chain. Because the convergence times are so different, the figure depicts every 10th tree for the first 2000 iterations, whereas for the NNI+SPR chain the figure depicts every 2nd tree for the first 400 iterations. Points represent trees projected onto the plane using multidimensional scaling based on the Robinson-Foulds distance. This distance depends only on the topology, not the branch lengths.</p></div></div></div></div></div><div id="Sec16" class="tsec sec"><h2 class="head no_bottom_margin" id="Sec16title">Discussion</h2><p id="__p87" class="p p-first">Some researchers question the ability of indel information to improve phylogenetic resolution of recently diverged taxa. Golenberg et al. analyze non-coding spacer regions between chloroplast genes in a parsimony framework and claim that indels shared by state recur more often than substitutions shared by state [<a href="#CR32" rid="CR32" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039489">32</a>], leading to a concern that indels are not reliable characters for phylogenetic analysis. However, Simmons and Ochoterana find indels to be reliable markers with low levels of homoplasy [<a href="#CR33" rid="CR33" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039478">33</a>]. This contrast is partially explained by noting that the original Golenberg study incorrectly codes overlapping gaps of different lengths as homologous, leading to false homoplasy. Improved methods of coding indels when gaps overlap can lead to more accurate and more informative indel characters [<a href="#CR33" rid="CR33" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039511">33</a>, <a href="#CR34" rid="CR34" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844967044">34</a>]. In addition, researchers note that chloroplast intergenic spacers contain indel "hotspots" and that sequence duplications or changes in the number of tandem repeats occur at a significantly higher rate than non-repeat indels [<a href="#CR32" rid="CR32" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039513">32</a>, <a href="#CR10" rid="CR10" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039495">10</a>]. This high rate can lead to identical but non-homologous insertions in different taxa, and so repeat indels experience higher homoplasy than non-repeat indels [<a href="#CR9" rid="CR9" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844967040">9</a>]. Repeat indels should therefore be down-weighted, but unfortunately an appropriate weighting scheme has not yet been developed [<a href="#CR35" rid="CR35" class=" bibr popnode">35</a>]. We also note that current alignment algorithms do not recognize duplications or indel hotspots, so that automatic alignments must be adjusted manually. Despite these difficulties with repeat indels, researchers have examined intergenic spacers in various plant species using improved indel coding and find that indel information is consistent with substitution information and largely reinforces it, improving phylogenetic resolution and support [<a href="#CR9" rid="CR9" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844967041">9</a>, <a href="#CR10" rid="CR10" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039493">10</a>]. In some analyses, indels are useful only in distinguishing larger groups [<a href="#CR36" rid="CR36" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039470">36</a>]. Despite the utility of indels in phylogeny estimation, most researchers note difficulties in indel coding that result from alignment ambiguity [<a href="#CR35" rid="CR35" class=" bibr popnode">35</a>]. This can be true even when the number of substitutions is too small to yield well-resolved phylogenies. While alignment ambiguity causes general problems with gap placement, some specific problems are worthy of mention. For example, aligning insertions of questionable homology may create spurious evidence for common ancestry [<a href="#CR35" rid="CR35" class=" bibr popnode">35</a>]. Also, when the number of tandem sequence repeats decreases, it is unclear which repeat has been deleted. Resolving these ambiguities to yield a single alignment can increase the support for some trees while decreasing the support for others, leading to bias, and so regions whose homology is uncertain should be thrown out [<a href="#CR35" rid="CR35" class=" bibr popnode">35</a>]. The joint estimation approach we advocate sidesteps many of the issues through the assignment of uncertainty on alignments, indel existence and placement.</p><p id="__p88" class="p p-last">Although the indel model described here improves on common multiple alignment algorithms by allowing indels to be shared by descent, it has some limitations. First, the model assumes that the indel rate is spatially homogeneous. However, biological sequences contain indel "hotspots" where indels are more likely to occur as well as invariant regions where indels are prohibited. Incorrectly accounting for rates at which indels occur in different regions can lead to over-weighting of the indel evidence. Clustal W attempts to place indels in hydrophilic regions of amino acid sequences, but does not have a mechanism for locating hotspots in non-coding sequences or hotspots resulting from weak selection or positive selection. Second, the indel model makes the common assumption that residues in a single sequence are never homologous. Duplications violate this assumption and are treated as insertions of random sequence by the indel process. Third, changes in the number of tandem repeats of a short sequence often occur at a higher rate than other indels via slipped-strand mispairing (SSM). However, no commonly used alignment program accounts for within-sequence homology or SSM. An improved stochastic process model that accounts for these properties of biological sequences is highly desirable in order to accurately weight shared indel evidence and to produce both more accurate alignments and phylogenies.</p></div><div id="Sec17" class="tsec sec"><h2 class="head no_bottom_margin" id="Sec17title">Conclusion</h2><p id="__p89" class="p p-first">We extend the joint Bayesian estimation framework of Redelings and Suchard [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039463">24</a>] for recently diverged SIV and HIV sequences to incorporate indel information into phylogeny estimates. In both examples, the use of indel information increases the number of supported bi-partitions even though the branch lengths are small, especially at high posterior probabilities. While many indels in these data sets occur in a single taxon or on a branch supported by many substitutions, some indels occur on branches with few or no substitutions. The relative weight of indels and substitutions shared by descent is specified by the relative rate <em>&#x003bb;</em> estimated from the data. This offers an improvement over existing methods that force the relative weight to be set a priori.</p><p id="__p90">Alignment uncertainty is significant in the SIV data set. This uncertainty is illustrated by the fact that the topology distribution under the traditional model varies significantly depending on the choice of alignment (Table <a href="/pmc/articles/PMC1853084/table/Tab1/" target="table" class="fig-table-link figpopup" rid-figpopup="Tab1" rid-ob="ob-Tab1" co-legend-rid=""><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3em;">(Table1).</span></span><span>1</span></a>). The joint estimation framework does not suffer from this sensitivity to alignment choice and allows alignment uncertainty to be estimated (Figure <a href="/pmc/articles/PMC1853084/figure/Fig4/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig4" rid-ob="ob-Fig4" co-legend-rid="lgnd_Fig4"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure4).</span></span><span>4</span></a>). We note that including indel information in analyses exaggerates the bias that results from fixing a single alignment choice. The high level of alignment uncertainty in the SIV data set is partially explained by a large number of occurrences of the triplet CAA. We note that in the HIV data set alignment uncertainty does not significantly effect the topology posterior.</p><p id="__p91" class="p p-last">Models such as M0 assume that codons are unbreakable, but the HIV data set shows that this can be unrealistic. Forcing indels to codon boundaries results in a decrease in model fit of 24.1 log units because of an increase in the number of inferred substitutions. Thus choosing a codon model over a singlet model involves a tradeoff between a substantially improved substitution model and a possibility of incorrect homology in the alignment. Because the effects of the latter can be significant when the total number of substitutions is small, we welcome the development of an improved substitution model that does not force this tradeoff. Such a substitution model would be able to calculate the likelihood of a singlet alignment while making use of codon frequencies and differentiating between synonymous and non-synonymous changes.</p></div><div id="Sec18" class="tsec sec"><h2 class="head no_bottom_margin" id="Sec18title">Methods</h2><div id="Sec19" class="sec sec-first"><h3 id="Sec19title">Detailed Balance for Collapsed-Point Transition Kernels</h3><p id="__p92" class="p p-first">We begin by considering a probability distribution <em>&#x003c0;</em>(<em>x</em>) on points <em>x</em> &#x02208; &#x003a9; and a function <em>f</em>(<em>x</em>) that associates a subset of &#x003a9; to each point <em>x</em> &#x02208; &#x003a9;. We call <em>f</em>(<em>x</em>) a collapsing function if for any <em>x</em> and <em>y</em> in &#x003a9; we have <em>x</em> &#x02208; <em>f</em>(<em>x</em>) and <em>f</em>(<em>x</em>) and <em>f</em>(<em>y</em>) are either identical or disjoint. If <em>f</em> is a collapsing function, then it partitions &#x003a9; into a set of non-overlapping subsets, which we refer to as collapsed points. We denote the set of collapsed points as <em>f</em>(&#x003a9;), and note that the probability <em>&#x003c0;</em>*(<em>f</em>(<em>x</em>)) of each collapsed point <em>f</em>(<em>x</em>) can be naturally defined as the integral of the probabilities <em>&#x003c0;</em>(<em>y</em>) of points <em>y</em> &#x02208; <em>f</em>(<em>x</em>). Because the collapsed points are disjoint sets, these probabilities sum to 1 and yield a probability distribution on collapsed points.</p><p id="__p93">We then consider a transition kernel <em>P</em> on &#x003a9; that is defined in terms of a transition kernel <em>P</em>* on <em>f</em>(&#x003a9;). Starting from the current point <em>x</em>, this transition kernel consists of collapsing <em>x</em> to <em>f</em>(<em>x</em>), moving to some other collapsed point <em>a</em>, and then selecting a point <em>y</em> from <em>a</em> in proportion to its probability <em>&#x003c0;</em>(<em>y</em>). We note that <em>y</em> &#x02208; <em>a</em> implies <em>a</em> = <em>f</em>(<em>y</em>) and write the probability expression for this transition kernel as</p><p id="__p94">\n<span id="IEq26"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>P</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>&#x000d7;</mo><mfrac><mrow><mi>&#x003c0;</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>&#x003c0;</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>.</mo><mrow><mo>(</mo><mrow><mn>11</mn></mrow><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaucqGGOaakcqWG4baEcqGGSaalcqWG5bqEcqGGPaqkcqGH9aqpcqWGqbaudaahaaWcbeqaaiabgEHiQaaakiabcIcaOiabdAgaMjabcIcaOiabdIha4jabcMcaPiabcYcaSiabdAgaMjabcIcaOiabdMha5jabcMcaPiabcMcaPiabgEna0oaalaaabaacciGae8hWdaNaeiikaGIaemyEaKNaeiykaKcabaGae8hWda3aaWbaaSqabeaacqGHxiIkaaGccqGGOaakcqWGMbGzcqGGOaakcqWG5bqEcqGGPaqkcqGGPaqkaaGaeiOla4IaaCzcaiaaxMaadaqadaqaaiabigdaXiabigdaXaGaayjkaiaawMcaaaaa@57FF@</annotation></semantics></math></span>\n</p><p id="__p95">The condition for <em>P</em> to satisfy detailed balance is</p><p id="__p96">\n<span id="IEq27"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27"><semantics><mrow><mi>&#x003c0;</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&#x000d7;</mo><msup><mi>P</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mfrac><mrow><mi>&#x003c0;</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>&#x003c0;</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>&#x003c0;</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>&#x000d7;</mo><msup><mi>P</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mfrac><mrow><mi>&#x003c0;</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msup><mi>&#x003c0;</mi><mo>&#x02217;</mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac><mo>.</mo><mrow><mo>(</mo><mrow><mn>12</mn></mrow><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCcqGGOaakcqWG4baEcqGGPaqkcqGHxdaTcqWGqbaudaahaaWcbeqaaiabgEHiQaaakiabcIcaOiabdAgaMjabcIcaOiabdIha4jabcMcaPiabcYcaSiabdAgaMjabcIcaOiabdMha5jabcMcaPiabcMcaPmaalaaabaGae8hWdaNaeiikaGIaemyEaKNaeiykaKcabaGae8hWda3aaWbaaSqabeaacqGHxiIkaaGccqGGOaakcqWGMbGzcqGGOaakcqWG5bqEcqGGPaqkcqGGPaqkaaGaeyypa0Jae8hWdaNaeiikaGIaemyEaKNaeiykaKIaey41aqRaemiuaa1aaWbaaSqabeaacqGHxiIkaaGccqGGOaakcqWGMbGzcqGGOaakcqWG5bqEcqGGPaqkcqGGSaalcqWGMbGzcqGGOaakcqWG4baEcqGGPaqkcqGGPaqkdaWcaaqaaiab=b8aWjabcIcaOiabdIha4jabcMcaPaqaaiab=b8aWnaaCaaaleqabaGaey4fIOcaaOGaeiikaGIaemOzayMaeiikaGIaemiEaGNaeiykaKIaeiykaKcaaiabc6caUiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaIYaGmaiaawIcacaGLPaaaaaa@7917@</annotation></semantics></math></span>\n</p><p id="__p97">By cancelling common terms.</p><p id="__p98"><em>&#x003c0;</em>* (<em>f</em>(<em>x</em>)) &#x000d7; <em>P</em>*(<em>f</em>(<em>x</em>), <em>f</em>(<em>y</em>)) = <em>&#x003c0;</em>* (<em>f</em>(<em>y</em>)) &#x000d7; <em>P</em>*(<em>f</em>(<em>y</em>), <em>f</em>(<em>x</em>)). &#x000a0;&#x000a0;&#x000a0; (13)</p><p id="__p99">Thus, the requirement for <em>P</em> to satisfy detailed balance on &#x003a9; is simply that <em>P</em>* satisfies detailed balance on <em>f</em>(&#x003a9;).</p><p id="__p100" class="p p-last">We now demonstrate that the function <em>f</em> that maps (<strong>A</strong>, <em>&#x003c4;</em>, <strong>T</strong>, <strong>&#x00398;</strong>, <strong>&#x0039b;</strong>) to <span id="IEq28"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28"><semantics><mrow><msub><mrow><mo stretchy="false">(</mo><mo>&#x02217;</mo><mo>,</mo><mi>&#x003c4;</mi><mo>,</mo><mi>T</mi><mo>,</mo><mi>&#x00398;</mi><mo>,</mo><mi>&#x0039b;</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>&#x003c4;</mi><mo>,</mo><mtext>PO</mtext><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqGGOaakcqGHxiIkcqGGSaaliiGacqWFepaDcqGGSaalieqacqGFubavcqGGSaaliiqacqqFyoqucqGGSaalcqqFBoatcqGGPaqkdaWgaaWcbaGaem4qam0aaSbaaWqaaiabikdaYaqabaWccqGGOaakcqWGbbqqcqGGSaalcqWFepaDcqGGSaalcqqGqbaucqqGpbWtcqGGPaqkaeqaaaaa@43A4@</annotation></semantics></math></span> is a collapsing function. The directed branch PO partitions the nodes of <em>&#x003c4;</em> into two subsets excluding node O (Figure <a href="/pmc/articles/PMC1853084/figure/Fig2/" target="figure" class="fig-table-link figpopup" rid-figpopup="Fig2" rid-ob="ob-Fig2" co-legend-rid="lgnd_Fig2"><span style="position: relative;text-decoration:none;">&#x200B;<span class="figpopup-sensitive-area" style="left: -3.5em;">(Figure2).</span></span><span>2</span></a>). Set <em>C</em><sub>2</sub> contains all alignments that are consistent with <strong>A</strong> on each of the two subsets. Alignment <strong>A</strong> certainly fulfills this criterion, and therefore <strong>A</strong> &#x02208; <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, PO), implying that <em>x</em> &#x02208; <em>f</em>(<em>x</em>) for any <em>x</em>. In addition, <em>C</em><sub>2</sub>(<strong>A</strong>\n<em>\'</em>, <em>&#x003c4;</em>, PO) = <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, PO) for any <strong>A</strong>\n<em>\'</em> in <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, PO) and so <em>f</em>(<em>y</em>) = <em>f</em>(<em>x</em>) for any <em>y</em> &#x02208; <em>f</em>(<em>x</em>), implying that <em>f</em>(<em>x</em>) and <em>f</em>(<em>y</em>) are either identical or non-overlapping. Therefore <em>f</em>(<em>x</em>) is a collapsing function. The transition kernel consisting of SPR proposals for points collapsed using <em>C</em><sub>2</sub>(<strong>A</strong>, <em>&#x003c4;</em>, PO) therefore satisfies detailed balance when we use the MH rule for acceptance or rejection and MH satisfies detailed balance on the collapsed points.</p></div><div id="Sec20" class="sec"><h3 id="Sec20title">Collapsed Sampling as an MH Proposal Distribution</h3><p id="__p101" class="p p-first">Our method for sampling alignments samples from a distribution <em>&#x003b7;</em> that approximates the correct distribution <em>&#x003c0;</em> but does not match exactly [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039475">24</a>]. We therefore define an MH transition kernel that uses collapsed sampling of alignments as a proposal distribution <em>&#x003c1;</em>. After selecting a new topology and alignment that goes along with it, we reject this new point <em>j</em> and move back to the original alignment and topology <em>i</em> with a small probability 1 - <em>&#x003b1;</em><sub><em>ij</em></sub>. The MH acceptance ratio can be calculated as follows:</p><p id="__p102">\n<span id="IEq29"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29"><semantics><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>&#x003c0;</mi><mi>i</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>&#x003b1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msub><mi>&#x003c0;</mi><mi>j</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><msub><mi>&#x003b1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo>,</mo></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><msub><mi>&#x003b1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><msub><mi>&#x003b1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><msub><mi>&#x003c0;</mi><mi>j</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><mrow><msub><mi>&#x003c0;</mi><mi>i</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>.</mo></mrow></mtd></mtr></mtable><mrow><mo>(</mo><mrow><mn>14</mn></mrow><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeGadaaabaacciGae8hWda3aaSbaaSqaaiabdMgaPbqabaGccqWFbpGCdaWgaaWcbaGaemyAaKMaemOAaOgabeaakiab=f7aHnaaBaaaleaacqWGPbqAcqWGQbGAaeqaaaGcbaGaeyypa0dabaGae8hWda3aaSbaaSqaaiabdQgaQbqabaGccqWFbpGCdaWgaaWcbaGaemOAaOMaemyAaKgabeaakiab=f7aHnaaBaaaleaacqWGQbGAcqWGPbqAaeqaaOGaeiilaWcabaWaaSaaaeaacqWFXoqydaWgaaWcbaGaemyAaKMaemOAaOgabeaaaOqaaiab=f7aHnaaBaaaleaacqWGQbGAcqWGPbqAaeqaaaaaaOqaaiabg2da9aqaamaalaaabaGae8hWda3aaSbaaSqaaiabdQgaQbqabaGccqWFbpGCdaWgaaWcbaGaemOAaOMaemyAaKgabeaaaOqaaiab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGae8xWdi3aaSbaaSqaaiabdMgaPjabdQgaQbqabaaaaOGaeiOla4caaiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaI0aanaiaawIcacaGLPaaaaaa@6759@</annotation></semantics></math></span>\n</p><p id="__p103">The <em>&#x003c1;</em><sub><em>ij</em></sub>satisfy detailed balance with respect to another probability <em>&#x003b7;</em><sub><em>i</em></sub>= <em>&#x003c0;</em><sub><em>i</em></sub><em>f</em><sub><em>i</em></sub>. Thus,</p><p id="__p104">\n<span id="IEq30"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30"><semantics><mrow><mtable columnalign="left"><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>&#x003b7;</mi><mi>i</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msub><mi>&#x003b7;</mi><mi>j</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><msub><mi>&#x003c0;</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><msub><mi>&#x003c0;</mi><mi>j</mi></msub><msub><mi>f</mi><mi>j</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow></mtd></mtr><mtr columnalign="left"><mtd columnalign="left"><mrow><mfrac><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><msub><mi>f</mi><mi>j</mi></msub></mrow></mfrac></mrow></mtd><mtd columnalign="left"><mo>=</mo></mtd><mtd columnalign="left"><mrow><mfrac><mrow><msub><mi>&#x003c0;</mi><mi>j</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><mrow><msub><mi>&#x003c0;</mi><mi>i</mi></msub><msub><mi>&#x003c1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>.</mo></mrow></mtd></mtr></mtable><mrow><mo>(</mo><mrow><mn>15</mn></mrow><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeWadaaabaacciGae83TdG2aaSbaaSqaaiabdMgaPbqabaGccqWFbpGCdaWgaaWcbaGaemyAaKMaemOAaOgabeaaaOqaaiabg2da9aqaaiab=D7aOnaaBaaaleaacqWGQbGAaeqaaOGae8xWdi3aaSbaaSqaaiabdQgaQjabdMgaPbqabaaakeaacqWFapaCdaWgaaWcbaGaemyAaKgabeaakiabdAgaMnaaBaaaleaacqWGPbqAaeqaaOGae8xWdi3aaSbaaSqaaiabdMgaPjabdQgaQbqabaaakeaacqGH9aqpaeaacqWFapaCdaWgaaWcbaGaemOAaOgabeaakiabdAgaMnaaBaaaleaacqWGQbGAaeqaaOGae8xWdi3aaSbaaSqaaiabdQgaQjabdMgaPbqabaaakeaadaWcaaqaaiabdAgaMnaaBaaaleaacqWGPbqAaeqaaaGcbaGaemOzay2aaSbaaSqaaiabdQgaQbqabaaaaaGcbaGaeyypa0dabaWaaSaaaeaacqWFapaCdaWgaaWcbaGaemOAaOgabeaakiab=f8aYnaaBaaaleaacqWGQbGAcqWGPbqAaeqaaaGcbaGae8hWda3aaSbaaSqaaiabdMgaPbqabaGccqWFbpGCdaWgaaWcbaGaemyAaKMaemOAaOgabeaaaaGccqGGUaGlaaGaaCzcaiaaxMaadaqadaqaaiabigdaXiabiwda1aGaayjkaiaawMcaaaaa@70C5@</annotation></semantics></math></span>\n</p><p id="__p105">Therefore the acceptance ratio is:</p><p id="__p106">\n<span id="IEq31"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31"><semantics><mrow><mfrac><mrow><msub><mi>&#x003b1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><msub><mi>&#x003b1;</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><msub><mi>f</mi><mi>j</mi></msub></mrow></mfrac><mo>.</mo><mrow><mo>(</mo><mrow><mn>16</mn></mrow><mo>)</mo></mrow></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaGGaciab=f7aHnaaBaaaleaacqWGPbqAcqWGQbGAaeqaaaGcbaGae8xSde2aaSbaaSqaaiabdQgaQjabdMgaPbqabaaaaOGaeyypa0ZaaSaaaeaacqWGMbGzdaWgaaWcbaGaemyAaKgabeaaaOqaaiabdAgaMnaaBaaaleaacqWGQbGAaeqaaaaakiabc6caUiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaI2aGnaiaawIcacaGLPaaaaaa@4257@</annotation></semantics></math></span>\n</p><p id="__p107" class="p p-last">Distribution <em>f</em><sub><em>i</em></sub>is proportional to the product of the length distributions on the internal nodes and changes very slowly in <em>i</em>. Therefore <span id="IEq32"><math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32"><semantics><mrow><mfrac><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><msub><mi>f</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="MathType-MTEF">MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabdAgaMnaaBaaaleaacqWGPbqAaeqaaaGcbaGaemOzay2aaSbaaSqaaiabdQgaQbqabaaaaaaa@3280@</annotation></semantics></math></span> is usually quite close to one and there are few rejections.</p></div><div id="Sec21" class="sec"><h3 id="Sec21title">Assessing Alignment Ambiguity</h3><p id="__p108" class="p p-first-last">To assess alignment ambiguity we compare the posterior topology distribution for the full joint model to the distribution generated under models restricted to a fixed alignment. As these distributions may be sensitive to the specific alignment chosen, we use three different choices. These alignments are the estimates obtained from Clustal W [<a href="#CR37" rid="CR37" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039512">37</a>], Muscle [<a href="#CR38" rid="CR38" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039466">38</a>], and BAli-Phy [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039487">24</a>]. In the latter case, we fix the alignment to its Maximum A Posteriori (MAP) point determined jointly. We use the default parameters for Clustal W and Muscle. Parameters and models used by BAli-Phy are described in the <em>Results</em> section.</p></div><div id="Sec22" class="sec sec-last"><h3 id="Sec22title">Computation Time and Problem Size</h3><p id="__p109" class="p p-first-last">The inference method described in this paper and implemented in the BAli-Phy software [<a href="#CR24" rid="CR24" class=" bibr popnode tag_hotlink tag_tooltip" id="__tag_844039503">24</a>] requires significant computation time in order to handle alignment uncertainty and incorporate indel information. This means that it is often impractical to analyze data sets with greater than 12 taxa or sequence lengths longer than about 750 letters (nucleotide, amino acid, or codon). Analyzing data sets of this size often takes about a week on current hardware. However, we wish to emphasize two points. First, the long computation time is not required to make a simple estimate, but to obtain measures of confidence that are accurate enough to publish. For simple estimates or unpublished results, significantly larger data sets can be analyzed. Second, the amount of time required to analyze a data set depends not just on the size of the data set, but on various characteristics such as the level of uncertainty. For example, the second example in this paper contains 27 taxa of maximum length 612 and took about 3 weeks to analyze.</p></div></div><div id="idm140035586066272" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140035586066272title">Acknowledgements</h2><div class="sec"><p id="__p120">We would like to thank Vladimir Minin for many helpful discussions. B.D.R. is supported by NSF training grant DGE9987641 and NIH training grant GM008185. M.A.S. is supported in part by NIH grant GM068955, the UCLA AIDS Institute and the James B. Pendleton Charitable Trust.</p></div></div><div id="App1" class="tsec sec headless whole_rhythm"><!--/article/back/app-group/app/--><div id="Sec23" class="sec sec-first"><h3 id="Sec23title">Authors&#x02019; original submitted files for images</h3><p id="__p110" class="p p-first-last">Below are the links to the authors&#x02019; original submitted files for images.<span class="sup-box" id="MOESM1"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM1_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 1</a><sup>(924K, eps)</sup></span><span class="sup-box" id="MOESM2"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM2_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 2</a><sup>(994K, eps)</sup></span><span class="sup-box" id="MOESM3"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM3_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 3</a><sup>(937K, eps)</sup></span><span class="sup-box" id="MOESM4"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM4_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 4</a><sup>(1000K, eps)</sup></span><span class="sup-box" id="MOESM5"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM5_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 5</a><sup>(1.2M, eps)</sup></span><span class="sup-box" id="MOESM6"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM6_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 6</a><sup>(1020K, eps)</sup></span><span class="sup-box" id="MOESM7"><a href="/pmc/articles/PMC1853084/bin/12862_2006_334_MOESM7_ESM.eps" data-ga-action="click_feat_suppl">Authors&#x02019; original file for figure 7</a><sup>(1.7M, eps)</sup></span></p></div></div><div id="idm140035586068080" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140035586068080title">Footnotes</h2><!--back/fn-group--><div class="fm-sec half_rhythm small"><p class="fn sec" id="idm140035586067952"><p id="__p118" class="p p-first"><strong>Authors\' contributions</strong></p><p id="__p119" class="p p-last">MS formulated the problem and provided project management. BR designed the algorithms and models. BR performed the actual programming and computations. MS and BR analyzed the data. MS and BR wrote the paper. All authors read and approved the final manuscript.</p></p></div></div><div id="idm140035593753872aff-info" class="tsec sec"><h2 class="head no_bottom_margin" id="idm140035593753872aff-infotitle">Contributor Information</h2><p><span class="fm-affl">Benjamin D Redelings, </span><span class="fm-affl"><span class="email-label">Email: </span><a href="mailto:dev@null" data-email="ude.uscn@sgnileder_nimajneb" class="oemail">ude.uscn@sgnileder_nimajneb</a></span>.</p><p><span class="fm-affl">Marc A Suchard, </span><span class="fm-affl"><span class="email-label">Email: </span><a href="mailto:dev@null" data-email="ude.alcu@drahcusm" class="oemail">ude.alcu@drahcusm</a></span>.</p></div><div id="Bib1" class="tsec sec"><h2 class="head no_bottom_margin" id="Bib1title">References</h2><div class="ref-list-sec sec" id="reference-list"><div class="ref-cit-blk half_rhythm" id="CR1">1. <span class="element-citation">Gao F, Bailes E, Robertson DL, Chen Y, Rodenburg CM, Michael SF, Cummins LB, Arthur LO, Peeters M, Shaw GM, Sharp PM, Hahn BH. Origin of HIV-1 in the chimpanzee <em>Pan troglodytes troglodytes</em>. <span><span class="ref-journal">Nature. </span>1999;<span class="ref-vol">397</span>:436\xe2\x80\x93441. doi: 10.1038/17130.</span> [<a href="/pubmed/9989410" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1038%2F17130" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=Origin+of+HIV-1+in+the+chimpanzee+Pan+troglodytes+troglodytes&amp;author=F+Gao&amp;author=E+Bailes&amp;author=DL+Robertson&amp;author=Y+Chen&amp;author=CM+Rodenburg&amp;volume=397&amp;publication_year=1999&amp;pages=436-441&amp;pmid=9989410&amp;doi=10.1038/17130&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR2">2. <span class="element-citation">Rambaut A, Posada D, Crandall KA, Holmes EC. The causes and consequences of HIV evolution. <span><span class="ref-journal">Nature Reviews Genetics. </span>2004;<span class="ref-vol">5</span>:52\xe2\x80\x9361. doi: 10.1038/nrg1246.</span> [<a href="/pubmed/14708016" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1038%2Fnrg1246" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Nature+Reviews+Genetics&amp;title=The+causes+and+consequences+of+HIV+evolution&amp;author=A+Rambaut&amp;author=D+Posada&amp;author=KA+Crandall&amp;author=EC+Holmes&amp;volume=5&amp;publication_year=2004&amp;pages=52-61&amp;pmid=14708016&amp;doi=10.1038/nrg1246&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR3">3. <span class="element-citation">Lutzoni F, Wagner P, Reeb V, Zoller S. Integrating ambiguously aligned regions of DNA sequences in phylogenetic analyses without violating positional homology. <span><span class="ref-journal">Systematic Biology. </span>2000;<span class="ref-vol">49</span>:628\xe2\x80\x93651. doi: 10.1080/106351500750049743.</span> [<a href="/pubmed/12116431" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1080%2F106351500750049743" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Systematic+Biology&amp;title=Integrating+ambiguously+aligned+regions+of+DNA+sequences+in+phylogenetic+analyses+without+violating+positional+homology&amp;author=F+Lutzoni&amp;author=P+Wagner&amp;author=V+Reeb&amp;author=S+Zoller&amp;volume=49&amp;publication_year=2000&amp;pages=628-651&amp;pmid=12116431&amp;doi=10.1080/106351500750049743&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR4">4. <span class="element-citation">Shankarappa R, Margolick JB, Gange SJ, Rodrigo AG, Upchurch D, Farzadegan h, Gupta P, Rinaldo CR, Learn GH, He X, Huang XL, Mullins JI. Consistent Viral Evolutionary Changes Associated with the Progression of Human Immunodeficiency Virus Type 1 Infection. <span><span class="ref-journal">Journal of Virology. </span>1999;<span class="ref-vol">73</span>(12):10489\xe2\x80\x9310502.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC113104/">PMC free article</a>]</span> [<a href="/pubmed/10559367" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Virology&amp;title=Consistent+Viral+Evolutionary+Changes+Associated+with+the+Progression+of+Human+Immunodeficiency+Virus+Type+1+Infection&amp;author=R+Shankarappa&amp;author=JB+Margolick&amp;author=SJ+Gange&amp;author=AG+Rodrigo&amp;author=D+Upchurch&amp;volume=73&amp;issue=12&amp;publication_year=1999&amp;pages=10489-10502&amp;pmid=10559367&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR5">5. <span class="element-citation">Forsman ZH, Lednicky JA, Fox GE, Willson RG, White ZS, Halvorson SJ, Wong C, Jr AML, Butel JS. Phylogenetic Analysis of Polyomavirus Simian Virus 40 from Monkeys and Humans Reveals Genetic Variation. <span><span class="ref-journal">J Virol. </span>2004;<span class="ref-vol">78</span>(17):9306\xe2\x80\x939316. doi: 10.1128/JVI.78.17.9306-9316.2004.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC506915/">PMC free article</a>]</span> [<a href="/pubmed/15308725" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1128%2FJVI.78.17.9306-9316.2004" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=J+Virol&amp;title=Phylogenetic+Analysis+of+Polyomavirus+Simian+Virus+40+from+Monkeys+and+Humans+Reveals+Genetic+Variation&amp;author=ZH+Forsman&amp;author=JA+Lednicky&amp;author=GE+Fox&amp;author=RG+Willson&amp;author=ZS+White&amp;volume=78&amp;issue=17&amp;publication_year=2004&amp;pages=9306-9316&amp;pmid=15308725&amp;doi=10.1128/JVI.78.17.9306-9316.2004&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR6">6. <span class="element-citation">Travers SAA, Clawley JP, Glynn JR, Fine PEM, Crampin AC, Sibande F, Mulawa D, McCormack JOMGP. Timing and Reconstruction of the Most Recent Common Ancestor of the Subtype C Clade of Human Immunodeficiency Virus Type. <span><span class="ref-journal">J Virol. </span>2004;<span class="ref-vol">78</span>(19):10501\xe2\x80\x9310506. doi: 10.1128/JVI.78.19.10501-10506.2004.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC516391/">PMC free article</a>]</span> [<a href="/pubmed/15367616" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1128%2FJVI.78.19.10501-10506.2004" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=J+Virol&amp;title=Timing+and+Reconstruction+of+the+Most+Recent+Common+Ancestor+of+the+Subtype+C+Clade+of+Human+Immunodeficiency+Virus+Type&amp;author=SAA+Travers&amp;author=JP+Clawley&amp;author=JR+Glynn&amp;author=PEM+Fine&amp;author=AC+Crampin&amp;volume=78&amp;issue=19&amp;publication_year=2004&amp;pages=10501-10506&amp;pmid=15367616&amp;doi=10.1128/JVI.78.19.10501-10506.2004&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR7">7. <span class="element-citation">Rivera MC, Lake JA. Evidence that eukaryotes and eocyte prokaryotes are immediate relatives. <span><span class="ref-journal">Science. </span>1992;<span class="ref-vol">257</span>:74\xe2\x80\x9376. doi: 10.1126/science.1621096.</span> [<a href="/pubmed/1621096" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1126%2Fscience.1621096" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=Evidence+that+eukaryotes+and+eocyte+prokaryotes+are+immediate+relatives&amp;author=MC+Rivera&amp;author=JA+Lake&amp;volume=257&amp;publication_year=1992&amp;pages=74-76&amp;pmid=1621096&amp;doi=10.1126/science.1621096&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR8">8. <span class="element-citation">Rokas A, Holland PWH. Rare genomic change as a tool for phylogenetics. <span><span class="ref-journal">Trends in Ecology &#x00026; Evolution. </span>2000;<span class="ref-vol">15</span>(11):454\xe2\x80\x93459. doi: 10.1016/S0169-5347(00)01967-4.</span> [<a href="/pubmed/11050348" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1016%2FS0169-5347(00)01967-4" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Trends+in+Ecology+&#x00026;+Evolution&amp;title=Rare+genomic+change+as+a+tool+for+phylogenetics&amp;author=A+Rokas&amp;author=PWH+Holland&amp;volume=15&amp;issue=11&amp;publication_year=2000&amp;pages=454-459&amp;pmid=11050348&amp;doi=10.1016/S0169-5347(00)01967-4&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR9">9. <span class="element-citation">Crayn DM, Quinn CJ. The evolution of the atp<em>&#x003b2;-rbc</em> L Intergenic Spacer in the Epacrids (Ericales) and Its Systematic and Evolutionary Implications. <span><span class="ref-journal">Mol Phy Evol. </span>2000;<span class="ref-vol">16</span>(2):238\xe2\x80\x93252. doi: 10.1006/mpev.2000.0794.</span> [<a href="/pubmed/10942610" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1006%2Fmpev.2000.0794" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Mol+Phy+Evol&amp;title=The+evolution+of+the+atp&#x003b2;-rbc+L+Intergenic+Spacer+in+the+Epacrids+(Ericales)+and+Its+Systematic+and+Evolutionary+Implications&amp;author=DM+Crayn&amp;author=CJ+Quinn&amp;volume=16&amp;issue=2&amp;publication_year=2000&amp;pages=238-252&amp;doi=10.1006/mpev.2000.0794&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR10">10. <span class="element-citation">Ingvarsson PK, Ribstein S, Taylor D. Molecular Evolution of Insertions and Deletions in the Chloroplast Genome of <em>Silene</em>. <span><span class="ref-journal">Mol Biol Evol. </span>2003;<span class="ref-vol">20</span>(11):1737\xe2\x80\x931740. doi: 10.1093/molbev/msg163.</span> [<a href="/pubmed/12832644" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1093%2Fmolbev%2Fmsg163" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Mol+Biol+Evol&amp;title=Molecular+Evolution+of+Insertions+and+Deletions+in+the+Chloroplast+Genome+of+Silene&amp;author=PK+Ingvarsson&amp;author=S+Ribstein&amp;author=D+Taylor&amp;volume=20&amp;issue=11&amp;publication_year=2003&amp;pages=1737-1740&amp;pmid=12832644&amp;doi=10.1093/molbev/msg163&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR11">11. <span class="element-citation">Cheynier R, Kils-H&#x000fc;tten L, Meyehaus A, Wain-Hobson S. Insertion/deletion frequencies match those of point mutations in the hypervariable regions of the simian immunodeficiency virus surface envelope gene. <span><span class="ref-journal">Journal of General Virology. </span>2001;<span class="ref-vol">82</span>:1613\xe2\x80\x931619. doi: 10.1099/0022-1317-82-7-1613.</span> [<a href="/pubmed/11413372" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1099%2F0022-1317-82-7-1613" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+General+Virology&amp;title=Insertion/deletion+frequencies+match+those+of+point+mutations+in+the+hypervariable+regions+of+the+simian+immunodeficiency+virus+surface+envelope+gene&amp;author=R+Cheynier&amp;author=L+Kils-H&#x000fc;tten&amp;author=A+Meyehaus&amp;author=S+Wain-Hobson&amp;volume=82&amp;publication_year=2001&amp;pages=1613-1619&amp;pmid=11413372&amp;doi=10.1099/0022-1317-82-7-1613&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR12">12. <span class="element-citation">Ni YH, Chang MH, Hsu HY, Chen HL. Long-Term Follow-up Study of Core Gene Deletion Mutants in Children With Chronic Hepatitis B Virus Infection. <span><span class="ref-journal">Hepatology. </span>2000;<span class="ref-vol">32</span>:124\xe2\x80\x93128. doi: 10.1053/jhep.2000.8529.</span> [<a href="/pubmed/10869299" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1053%2Fjhep.2000.8529" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Hepatology&amp;title=Long-Term+Follow-up+Study+of+Core+Gene+Deletion+Mutants+in+Children+With+Chronic+Hepatitis+B+Virus+Infection&amp;author=YH+Ni&amp;author=MH+Chang&amp;author=HY+Hsu&amp;author=HL+Chen&amp;volume=32&amp;publication_year=2000&amp;pages=124-128&amp;pmid=10869299&amp;doi=10.1053/jhep.2000.8529&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR13">13. <span class="element-citation">Zheng YH, Sentsui H, Nakaya T, Kono Y, Ikuta K. <em>In Vivo</em> Dynamics of Equine Infectious Anemia Viruses Emerging during Febrile Episodes: Insertions/Duplications at the Principal Neutralizing Domain. <span><span class="ref-journal">Journal of Virology. </span>1997;<span class="ref-vol">71</span>(7):5031\xe2\x80\x935039.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC191736/">PMC free article</a>]</span> [<a href="/pubmed/9188568" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Virology&amp;title=In+Vivo+Dynamics+of+Equine+Infectious+Anemia+Viruses+Emerging+during+Febrile+Episodes:+Insertions/Duplications+at+the+Principal+Neutralizing+Domain&amp;author=YH+Zheng&amp;author=H+Sentsui&amp;author=T+Nakaya&amp;author=Y+Kono&amp;author=K+Ikuta&amp;volume=71&amp;issue=7&amp;publication_year=1997&amp;pages=5031-5039&amp;pmid=9188568&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR14">14. <span class="element-citation">Chinese SARS Molecular Epidemiology Consortium  Molecular Evolution of the SARS Coronavirus During the Course of the SARS Epidemic in China. <span><span class="ref-journal">Science. </span>2004;<span class="ref-vol">303</span>:1666\xe2\x80\x931669. doi: 10.1126/science.1092002.</span> [<a href="/pubmed/14752165" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1126%2Fscience.1092002" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=Molecular+Evolution+of+the+SARS+Coronavirus+During+the+Course+of+the+SARS+Epidemic+in+China&amp;volume=303&amp;publication_year=2004&amp;pages=1666-1669&amp;pmid=14752165&amp;doi=10.1126/science.1092002&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR15">15. <span class="element-citation">McCullers JA, Wang GC, He S, Webster RG. Reassortment and Insertion-Deletion are Strategies for the Evolution of Influenza B Viruses in Nature. <span><span class="ref-journal">Journal of Virology. </span>1999;<span class="ref-vol">73</span>(9):7343\xe2\x80\x937348.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC104260/">PMC free article</a>]</span> [<a href="/pubmed/10438823" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Virology&amp;title=Reassortment+and+Insertion-Deletion+are+Strategies+for+the+Evolution+of+Influenza+B+Viruses+in+Nature&amp;author=JA+McCullers&amp;author=GC+Wang&amp;author=S+He&amp;author=RG+Webster&amp;volume=73&amp;issue=9&amp;publication_year=1999&amp;pages=7343-7348&amp;pmid=10438823&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR16">16. <span class="element-citation">Gatesy J, DeSalle R, Wheeler W. Alignment-ambiguous nucleotide sites and the exclusion of systematic data. <span><span class="ref-journal">Molecular Phylogenetics and Evolution. </span>1993;<span class="ref-vol">2</span>:152\xe2\x80\x93157. doi: 10.1006/mpev.1993.1015.</span> [<a href="/pubmed/8025721" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1006%2Fmpev.1993.1015" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Phylogenetics+and+Evolution&amp;title=Alignment-ambiguous+nucleotide+sites+and+the+exclusion+of+systematic+data&amp;author=J+Gatesy&amp;author=R+DeSalle&amp;author=W+Wheeler&amp;volume=2&amp;publication_year=1993&amp;pages=152-157&amp;pmid=8025721&amp;doi=10.1006/mpev.1993.1015&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR17">17. <span class="element-citation">Wheeler WC, Gatesy J, DeSalle R. Elision: a method for accommodating multiple molecular sequence alignments with alignment-ambiguous sites. <span><span class="ref-journal">Molecular Phylogenetics and Evolution. </span>1995;<span class="ref-vol">4</span>:1\xe2\x80\x939. doi: 10.1006/mpev.1995.1001.</span> [<a href="/pubmed/7620631" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1006%2Fmpev.1995.1001" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Phylogenetics+and+Evolution&amp;title=Elision:+a+method+for+accommodating+multiple+molecular+sequence+alignments+with+alignment-ambiguous+sites&amp;author=WC+Wheeler&amp;author=J+Gatesy&amp;author=R+DeSalle&amp;volume=4&amp;publication_year=1995&amp;pages=1-9&amp;pmid=7620631&amp;doi=10.1006/mpev.1995.1001&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR18">18. <span class="element-citation">Thorne JL, Kishino H. Freeing phylogenies from artifacts of alignment. <span><span class="ref-journal">Molecular Biology and Evolution. </span>1992;<span class="ref-vol">9</span>:1148\xe2\x80\x931162.</span> [<a href="/pubmed/1435239" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Biology+and+Evolution&amp;title=Freeing+phylogenies+from+artifacts+of+alignment&amp;author=JL+Thorne&amp;author=H+Kishino&amp;volume=9&amp;publication_year=1992&amp;pages=1148-1162&amp;pmid=1435239&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR19">19. <span class="element-citation">Sankoff D, Cedergren RJ, Lapalme G. Frequency of Insertion-Deletion, Transversion, and Transition in the Evolution of 5S Ribosomal RNA. <span><span class="ref-journal">J Mol Evol. </span>1976;<span class="ref-vol">7</span>:133\xe2\x80\x93149. doi: 10.1007/BF01732471.</span> [<a href="/pubmed/772222" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1007%2FBF01732471" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=J+Mol+Evol&amp;title=Frequency+of+Insertion-Deletion,+Transversion,+and+Transition+in+the+Evolution+of+5S+Ribosomal+RNA&amp;author=D+Sankoff&amp;author=RJ+Cedergren&amp;author=G+Lapalme&amp;volume=7&amp;publication_year=1976&amp;pages=133-149&amp;pmid=772222&amp;doi=10.1007/BF01732471&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR20">20. <span class="element-citation">Wheeler WC. Iterative pass optimization of sequence data. <span><span class="ref-journal">Cladistics. </span>2003;<span class="ref-vol">19</span>(3):254\xe2\x80\x93260. doi: 10.1111/j.1096-0031.2003.tb00368.x.</span> [<a href="/pubmed/12901382" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1111%2Fj.1096-0031.2003.tb00368.x" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Cladistics&amp;title=Iterative+pass+optimization+of+sequence+data&amp;author=WC+Wheeler&amp;volume=19&amp;issue=3&amp;publication_year=2003&amp;pages=254-260&amp;pmid=12901382&amp;doi=10.1111/j.1096-0031.2003.tb00368.x&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR21">21. <span class="element-citation">Lake JA. The order of sequence alignment can bias the selection of tree topology. <span><span class="ref-journal">Molecular Biology and Evolution. </span>1991;<span class="ref-vol">8</span>:378\xe2\x80\x93385.</span> [<a href="/pubmed/2072863" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Biology+and+Evolution&amp;title=The+order+of+sequence+alignment+can+bias+the+selection+of+tree+topology&amp;author=JA+Lake&amp;volume=8&amp;publication_year=1991&amp;pages=378-385&amp;pmid=2072863&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR22">22. <span class="element-citation">Thorne JL, Kishino H, Felsenstein J. An evolutionary model for maximum likelihood alignment of DNA sequences. <span><span class="ref-journal">Journal of Molecular Evolution. </span>1991;<span class="ref-vol">33</span>:114\xe2\x80\x93124. doi: 10.1007/BF02193625.</span> [<a href="/pubmed/1920447" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1007%2FBF02193625" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Molecular+Evolution&amp;title=An+evolutionary+model+for+maximum+likelihood+alignment+of+DNA+sequences&amp;author=JL+Thorne&amp;author=H+Kishino&amp;author=J+Felsenstein&amp;volume=33&amp;publication_year=1991&amp;pages=114-124&amp;pmid=1920447&amp;doi=10.1007/BF02193625&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR23">23. <span class="element-citation">Thorne JL, Kishino H, Felsenstein J. Inching towards reality: an improved likelihood model of sequence evolution. <span><span class="ref-journal">Journal of Molecular Evolution. </span>1992;<span class="ref-vol">34</span>:3\xe2\x80\x9316. doi: 10.1007/BF00163848.</span> [<a href="/pubmed/1556741" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1007%2FBF00163848" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Molecular+Evolution&amp;title=Inching+towards+reality:+an+improved+likelihood+model+of+sequence+evolution&amp;author=JL+Thorne&amp;author=H+Kishino&amp;author=J+Felsenstein&amp;volume=34&amp;publication_year=1992&amp;pages=3-16&amp;pmid=1556741&amp;doi=10.1007/BF00163848&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR24">24. <span class="element-citation">Redelings B, Suchard M. Joint Bayesian Estimation of Alignment and Phylogeny. <span><span class="ref-journal">Systematic Biology. </span>2005;<span class="ref-vol">54</span>(3):401\xe2\x80\x93418. doi: 10.1080/10635150590947041.</span> [<a href="/pubmed/16012107" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1080%2F10635150590947041" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Systematic+Biology&amp;title=Joint+Bayesian+Estimation+of+Alignment+and+Phylogeny&amp;author=B+Redelings&amp;author=M+Suchard&amp;volume=54&amp;issue=3&amp;publication_year=2005&amp;pages=401-418&amp;pmid=16012107&amp;doi=10.1080/10635150590947041&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR25">25. <span class="element-citation">Goldman N, Yang Z. A codon-based model of nucleotide substitution for protein-coding DNA sequences. <span><span class="ref-journal">Molecular Biology and Evolution. </span>1994;<span class="ref-vol">11</span>:725\xe2\x80\x93736.</span> [<a href="/pubmed/7968486" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Biology+and+Evolution&amp;title=A+codon-based+model+of+nucleotide+substitution+for+protein-coding+DNA+sequences&amp;author=N+Goldman&amp;author=Z+Yang&amp;volume=11&amp;publication_year=1994&amp;pages=725-736&amp;pmid=7968486&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR26">26. <span class="element-citation">Lange K.  <span class="ref-journal">Mathematical and Statistical Methods for Genetic Analysis.</span> New York: Springer-Verlag; 1997.  <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?title=Mathematical+and+Statistical+Methods+for+Genetic+Analysis&amp;author=K+Lange&amp;publication_year=1997&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR27">27. <span class="element-citation">Allen B, Steel M. Subtree Transfer Operations and their Induced Metrics on Evolutionary Trees. <span><span class="ref-journal">Annals of Combinatorics. </span>2001;<span class="ref-vol">5</span>:1\xe2\x80\x9315. doi: 10.1007/s00026-001-8006-8.</span> [<a href="//dx.doi.org/10.1007%2Fs00026-001-8006-8" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Annals+of+Combinatorics&amp;title=Subtree+Transfer+Operations+and+their+Induced+Metrics+on+Evolutionary+Trees&amp;author=B+Allen&amp;author=M+Steel&amp;volume=5&amp;publication_year=2001&amp;pages=1-15&amp;doi=10.1007/s00026-001-8006-8&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR28">28. <span class="element-citation">Liu J.  <span class="ref-journal">Monte Carlo Strategies in Scientific Computing.</span> New York, NY: Springer; 2001.  <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?title=Monte+Carlo+Strategies+in+Scientific+Computing&amp;author=J+Liu&amp;publication_year=2001&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR29">29. <span class="element-citation">Goldman N, Whelan S. A Novel Use of Equilibrium Frequencies in Models of Sequence Evolution. <span><span class="ref-journal">Molecular Biology and Evolution. </span>2002;<span class="ref-vol">19</span>(11):1821\xe2\x80\x931831. doi: 10.1093/oxfordjournals.molbev.a004007.</span> [<a href="/pubmed/12411592" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1093%2Foxfordjournals.molbev.a004007" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Biology+and+Evolution&amp;title=A+Novel+Use+of+Equilibrium+Frequencies+in+Models+of+Sequence+Evolution&amp;author=N+Goldman&amp;author=S+Whelan&amp;volume=19&amp;issue=11&amp;publication_year=2002&amp;pages=1821-1831&amp;pmid=12411592&amp;doi=10.1093/oxfordjournals.molbev.a004007&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR30">30. <span class="element-citation">Hasegawa M, Kishino H, Yano T. Dating of the human-ape splitting by a molecular clock of mitochondrial DNA. <span><span class="ref-journal">Journal of Molecular Evolution. </span>1985;<span class="ref-vol">12</span>:160\xe2\x80\x93174. doi: 10.1007/BF02101694.</span> [<a href="/pubmed/3934395" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1007%2FBF02101694" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Journal+of+Molecular+Evolution&amp;title=Dating+of+the+human-ape+splitting+by+a+molecular+clock+of+mitochondrial+DNA&amp;author=M+Hasegawa&amp;author=H+Kishino&amp;author=T+Yano&amp;volume=12&amp;publication_year=1985&amp;pages=160-174&amp;doi=10.1007/BF02101694&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR31">31. <span class="element-citation">Cheynier R, Gratton S, Hallorn M, Stahmer I, Letvin NL, Wain-Hobson S. Antigenic Stimulation by BGC vaccine as an <em>in vivo</em> driving force for SIV replication and dissemination. <span><span class="ref-journal">Nature Medicine. </span>1998;<span class="ref-vol">4</span>(4):421\xe2\x80\x93427. doi: 10.1038/nm0498-421.</span> [<a href="/pubmed/9546787" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1038%2Fnm0498-421" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Nature+Medicine&amp;title=Antigenic+Stimulation+by+BGC+vaccine+as+an+in+vivo+driving+force+for+SIV+replication+and+dissemination&amp;author=R+Cheynier&amp;author=S+Gratton&amp;author=M+Hallorn&amp;author=I+Stahmer&amp;author=NL+Letvin&amp;volume=4&amp;issue=4&amp;publication_year=1998&amp;pages=421-427&amp;pmid=9546787&amp;doi=10.1038/nm0498-421&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR32">32. <span class="element-citation">Golenberg EM, Clegg MT, Durbin ML, Doebly D, Ma DP. Evolution of a Noncoding Region of the Chloroplast Genome. <span><span class="ref-journal">Molecular Phylogenetics and Evolution. </span>1993;<span class="ref-vol">2</span>:52\xe2\x80\x9364. doi: 10.1006/mpev.1993.1006.</span> [<a href="/pubmed/8081547" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1006%2Fmpev.1993.1006" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Molecular+Phylogenetics+and+Evolution&amp;title=Evolution+of+a+Noncoding+Region+of+the+Chloroplast+Genome&amp;author=EM+Golenberg&amp;author=MT+Clegg&amp;author=ML+Durbin&amp;author=D+Doebly&amp;author=DP+Ma&amp;volume=2&amp;publication_year=1993&amp;pages=52-64&amp;pmid=8081547&amp;doi=10.1006/mpev.1993.1006&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR33">33. <span class="element-citation">Simmons MP, Ochoterena H. Gaps as characters in sequence-based phylogenetic analyses. <span><span class="ref-journal">Systematic Biology. </span>2000;<span class="ref-vol">49</span>:369\xe2\x80\x93381. doi: 10.1093/sysbio/49.2.369.</span> [<a href="/pubmed/12118412" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1093%2Fsysbio%2F49.2.369" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Systematic+Biology&amp;title=Gaps+as+characters+in+sequence-based+phylogenetic+analyses&amp;author=MP+Simmons&amp;author=H+Ochoterena&amp;volume=49&amp;publication_year=2000&amp;pages=369-381&amp;pmid=12118412&amp;doi=10.1093/sysbio/49.2.369&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR34">34. <span class="element-citation">M&#x000fc;ller K.  <span class="ref-journal">Molecular Phylogenetics and Evolution.</span> 2005. Incorporating information from length-mutational events into phylogenetic analysis. [<a href="/pubmed/16129628" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?title=Molecular+Phylogenetics+and+Evolution&amp;author=K+M&#x000fc;ller&amp;publication_year=2005&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR35">35. <span class="element-citation">Kelchner SA. The evolution of the non-coding Chloroplast DNA and its application in Plant Systematics. <span><span class="ref-journal">Ann Missouri Bot Card. </span>2000;<span class="ref-vol">87</span>:482\xe2\x80\x93498. doi: 10.2307/2666142.</span> [<a href="//dx.doi.org/10.2307%2F2666142" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Ann+Missouri+Bot+Card&amp;title=The+evolution+of+the+non-coding+Chloroplast+DNA+and+its+application+in+Plant+Systematics&amp;author=SA+Kelchner&amp;volume=87&amp;publication_year=2000&amp;pages=482-498&amp;doi=10.2307/2666142&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR36">36. <span class="element-citation">Stoneberg-Holt SD, Horov&#x000e1; L, Bure&#x0015d; P. Indel patterns of the plastid DNA <em>trnL-trnF</em> region within the genus <em>Poa</em> (Poaceae) <span><span class="ref-journal">J Plant Res. </span>2004;<span class="ref-vol">117</span>:393\xe2\x80\x93407. doi: 10.1007/s10265-004-0172-4.</span> [<a href="/pubmed/15368095" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1007%2Fs10265-004-0172-4" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=J+Plant+Res&amp;title=Indel+patterns+of+the+plastid+DNA+trnL-trnF+region+within+the+genus+Poa+(Poaceae)&amp;author=SD+Stoneberg-Holt&amp;author=L+Horov&#x000e1;&amp;author=P+Bure&#x0015d;&amp;volume=117&amp;publication_year=2004&amp;pages=393-407&amp;pmid=15368095&amp;doi=10.1007/s10265-004-0172-4&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR37">37. <span class="element-citation">Thompson JD, Higgins DG, Gibson TJ. CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position specific gap penalties and weight matrix choice. <span><span class="ref-journal">Nucleic Acids Research. </span>1994;<span class="ref-vol">22</span>(22):4673\xe2\x80\x934680. doi: 10.1093/nar/22.22.4673.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC308517/">PMC free article</a>]</span> [<a href="/pubmed/7984417" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1093%2Fnar%2F22.22.4673" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Nucleic+Acids+Research&amp;title=CLUSTAL+W:+improving+the+sensitivity+of+progressive+multiple+sequence+alignment+through+sequence+weighting,+position+specific+gap+penalties+and+weight+matrix+choice&amp;author=JD+Thompson&amp;author=DG+Higgins&amp;author=TJ+Gibson&amp;volume=22&amp;issue=22&amp;publication_year=1994&amp;pages=4673-4680&amp;pmid=7984417&amp;doi=10.1093/nar/22.22.4673&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div><div class="ref-cit-blk half_rhythm" id="CR38">38. <span class="element-citation">Edgar RC. MUSCLE: multiple sequence alignment with high accuracy and high throughput. <span><span class="ref-journal">Nucleic Acids Research. </span>2004;<span class="ref-vol">32</span>(5):1792\xe2\x80\x931797. doi: 10.1093/nar/gkh340.</span> <span class="nowrap">[<a class="int-reflink" href="/pmc/articles/PMC390337/">PMC free article</a>]</span> [<a href="/pubmed/15034147" target="pmc_ext" ref="reftype=pubmed&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Entrez%7CPubMed%7CRecord">PubMed</a>] [<a href="//dx.doi.org/10.1093%2Fnar%2Fgkh340" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CCrosslink%7CDOI">CrossRef</a>] <span class="nowrap">[<a href="https://scholar.google.com/scholar_lookup?journal=Nucleic+Acids+Research&amp;title=MUSCLE:+multiple+sequence+alignment+with+high+accuracy+and+high+throughput&amp;author=RC+Edgar&amp;volume=32&amp;issue=5&amp;publication_year=2004&amp;pages=1792-1797&amp;pmid=15034147&amp;doi=10.1093/nar/gkh340&amp;" target="pmc_ext" ref="reftype=other&amp;article-id=1853084&amp;issue-id=354737&amp;journal-id=3814&amp;FROM=Article%7CCitationRef&amp;TO=Content%20Provider%7CLink%7CGoogle%20Scholar">Google Scholar</a>]</span></span></div></div></div></div><!--post-content--></div>\n            \n            \n        \n            \n        </div>\n        <!-- Book content -->\n    </div>\n    \n    <div id="rightcolumn" class="four_col col last">\n        <!-- Custom content above discovery portlets -->\n        <div class="col6">\n            \n        </div>\n        \n        <div xmlns:np="http://ncbi.gov/portal/XSLT/namespace" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><div class="format-menu"><h2>Formats:</h2><ul><li class="selected">Article</li> | <li><a href="/pmc/articles/PMC1853084/?report=reader">PubReader</a></li> | <li class="epub-link"><a href="/pmc/articles/PMC1853084/epub/">ePub (beta)</a></li> | <li><a href="/pmc/articles/PMC1853084/pdf/12862_2006_Article_334.pdf">PDF (750K)</a></li> | <li><a href="#" data-citationid="PMC1853084" class="citationexporter ctxp">Citation</a></li></ul></div></div><div xmlns:np="http://ncbi.gov/portal/XSLT/namespace" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" class="share-buttons"><h2>Share</h2><ul><li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC1853084%2F"><img src="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/img/4047626" alt="Share on Facebook" />\n                             Facebook\n                        </a></li><li class="twitter"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC1853084%2F&amp;text=Incorporating%20indel%20information%20into%20phylogeny%20estimation%20for%20rapidly%20emerging%20pathogens"><img src="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/img/4047627" alt="Share on Twitter" />\n                             Twitter\n                        </a></li><li class="gplus"><a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC1853084%2F"><img src="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/img/4047628" alt="Share on Google Plus" />\n                             Google+\n                        </a></li></ul></div>\n        \n        <div id="ajax-portlets" data-pmid="17359539" data-aiid="7090631" data-aid="1853084" data-iid="354737" data-domainid="3814" data-domain="phenaturepg" data-accid="PMC1853084" data-md5="474f43aed3af0462ae01f47f9aecd205"></div>\n                \n        <!-- Custom content below discovery portlets -->\n        <div class="col7">\n            \n        </div>\n    </div>\n</div>\n\n<!-- Custom content after all -->\n<div class="col8">\n    \n</div>\n<div class="col9">\n    \n</div>\n\n<script src="/corehtml/pmc/js/jquery.scrollTo-1.4.2.js"></script>\n<script>\n    (function($){\n        $(\'.skiplink\').each(function(i, item){\n            var href = $($(item).attr(\'href\'));\n            href.attr(\'tabindex\', \'-1\').addClass(\'skiptarget\'); // ensure the target can receive focus\n            $(item).on(\'click\', function(event){\n                event.preventDefault();\n                $.scrollTo(href, 0, {\n                    onAfter: function(){\n                        href.focus();\n                    }\n                });\n            });\n        });\n    })(jQuery);\n</script>\n\n\n\n<div id="body-link-poppers"></div>\n                        </div>\n                        <div class="bottom">\n                            \n                            <div id="NCBIFooter_dynamic">\n    <a id="help-desk-link" class="help_desk" href="" target="_blank">Support Center</a>\n    <a id="help-desk-link" class="help_desk" href="https://support.ncbi.nlm.nih.gov/ics/support/KBList.asp?Time=2020-04-17T09:27:19-04:00&amp;Snapshot=%2Fprojects%2FPMC%2FPMCViewer@4.46&amp;Host=ptpmc101&amp;ncbi_phid=8A1A6FD0E999E28100000000093E093D&amp;ncbi_session=8A1A6FD0E99AEB61_2366SID&amp;from=https%3A%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC1853084%2F&amp;Db=pmc&amp;folderID=132&amp;Ncbi_App=pmc&amp;Page=literature&amp;style=classic&amp;deptID=28049" target="_blank">Support Center</a>\n    \n</div>\n\n                            <div class="footer" id="footer">\n    \n    <div class="subfooter"> </div><script type="text/javascript" src="/portal/portal3rc.fcgi/static/js/preloaderWidget.js"> </script>\n    <div id="external-disclaimer" class="offscreen_noflow">\n        External link. Please review our <a href="https://www.nlm.nih.gov/privacy.html">privacy policy</a>.\n    </div>    \n    <div id="ncbifooter" class="contact_info">      \n        <div id="footer-contents-right">\n            <div id="nlm_thumb_logo">\n                <a href="https://www.nlm.nih.gov" title="NLM">NLM</a>\n            </div>\n            <div id="nih_thumb_logo">\n                <a href="https://www.nih.gov" title="NIH">NIH</a>\n            </div>\n            <div id="hhs_thumb_logo">\n                <a href="https://www.hhs.gov" title="DHHS">DHHS</a>\n            </div>\n            <div id="usagov_thumb_logo">\n                <a href="https://www.usa.gov" title="USA.gov">USA.gov</a>\n            </div>         \n        </div>\n        \n        <div id="footer-contents-left">\n            <p class="address vcard">\n                <span class="url">\n                    <a class="fn url newdomain" href="https://www.ncbi.nlm.nih.gov">National Center for\n                        Biotechnology Information</a>,\n                </span> <span class="org url newdomain"><a href="https://www.nlm.nih.gov/">U.S. National Library of Medicine</a></span>\n                <span class="adr">\n                    <span class="street-address">8600 Rockville Pike</span>, <span class="locality">Bethesda</span>\n                    <span class="region">MD</span>, <span class="postal-code">20894</span>\n                    <span class="country-name">USA</span>\n                </span>\n            </p>\n            \n            <a href="/home/about/policies.shtml">Policies and Guidelines</a> | <a href="/home/about/contact.shtml">Contact</a>\n        </div>\n    </div>\n    <script type="text/javascript" src="/portal/portal3rc.fcgi/rlib/js/InstrumentOmnitureBaseJS/InstrumentNCBIConfigJS/InstrumentNCBIBaseJS/InstrumentPageStarterJS.js?v=1"> </script>    \n    <script type="text/javascript" src="/portal/portal3rc.fcgi/static/js/hfjs2.js"> </script>\n</div>\n                        </div>\n                    </div>\n                    <!--/.page-->\n                </div>\n                <!--/.wrap-->\n            </div><!-- /.twelve_col -->\n        </div>\n        <!-- /.grid -->\n\n        <span class="PAFAppResources"></span>\n        \n        <!-- BESelector tab -->\n        \n        \n        \n        <noscript><img alt="statistics" src="/stat?jsdisabled=true&amp;ncbi_db=pmc&amp;ncbi_pdid=article&amp;ncbi_acc=&amp;ncbi_domain=phenaturepg&amp;ncbi_report=record&amp;ncbi_type=fulltext&amp;ncbi_objectid=&amp;ncbi_pcid=/articles/PMC1853084/&amp;ncbi_app=pmc" /></noscript>\n        \n        \n        <!-- usually for JS scripts at page bottom -->\n        <!--<component id="PageFixtures" label="styles"></component>-->\n    \n\n<!-- 8A1A6FD0E99AEB61_2366SID /projects/PMC/PMCViewer@4.46 ptpmc101 v4.1.r585844 Mon, May 06 2019 02:53:16 -->\n\n<script type="text/javascript" src="//static.pubmed.gov/portal/portal3rc.fcgi/4160049/js/3879255/4121861/3818874/4168176/3821238/4117325/4087685/4072593/4076480/3921943/4105668/4065628.js" snapshot="pmc"></script></body>\n</html>'